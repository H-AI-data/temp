# ä¼ä¸šçº§ AI Agent å¹³å°æ¶æ„è®¾è®¡æ–‡æ¡£

> ç‰ˆæœ¬ï¼šv1.0  
> æ—¥æœŸï¼š2026-02-10  
> æŠ€æœ¯æ ˆï¼šOpenManus + Letta + LiteLLM + MCP

---

## ç›®å½•

1. [å‰æœŸè°ƒç ”ï¼šæ¡†æ¶å¯¹æ¯”åˆ†æ](#1-å‰æœŸè°ƒç ”æ¡†æ¶å¯¹æ¯”åˆ†æ)
2. [é¡¹ç›®æ¦‚è¿°](#2-é¡¹ç›®æ¦‚è¿°)
3. [æ•´ä½“æ¶æ„](#3-æ•´ä½“æ¶æ„)
4. [å¤§æ¨¡å‹è°ƒç”¨ç¯èŠ‚è¯´æ˜](#4-å¤§æ¨¡å‹è°ƒç”¨ç¯èŠ‚è¯´æ˜)
5. [æ ¸å¿ƒç»„ä»¶è¯¦è§£](#5-æ ¸å¿ƒç»„ä»¶è¯¦è§£)
6. [ä¸Šä¸‹æ–‡ç®¡ç†è®¾è®¡](#6-ä¸Šä¸‹æ–‡ç®¡ç†è®¾è®¡)
7. [æ¨¡å‹ç®¡ç†è®¾è®¡](#7-æ¨¡å‹ç®¡ç†è®¾è®¡)
8. [Tool/Skill/MCP ç®¡ç†è®¾è®¡](#8-toolskillmcp-ç®¡ç†è®¾è®¡)
9. [åœºæ™¯å®ç°è¯¦è§£](#9-åœºæ™¯å®ç°è¯¦è§£)
10. [API è®¾è®¡](#10-api-è®¾è®¡)
11. [æ•°æ®åº“è®¾è®¡](#11-æ•°æ®åº“è®¾è®¡)
12. [éƒ¨ç½²æ¶æ„](#12-éƒ¨ç½²æ¶æ„)
13. [å¼€å‘è·¯çº¿å›¾](#13-å¼€å‘è·¯çº¿å›¾)

---

## 1. å‰æœŸè°ƒç ”ï¼šæ¡†æ¶å¯¹æ¯”åˆ†æ

### 1.1 å€™é€‰æ¡†æ¶æ¦‚è§ˆ

| æ¡†æ¶ | æ¥æºå›¢é˜Ÿ | GitHub Stars | æŠ€æœ¯æ ˆ | åè®® | å®šä½ |
|------|----------|--------------|--------|------|------|
| **OpenManus** | MetaGPT (æ¸…å) | 54k | Python | MIT | é€šç”¨ Agent æ¡†æ¶ |
| **LangGraph** | LangChain | ~15k | Python | MIT | Agent ç¼–æ’å¼•æ“ |
| **OpenClaw** | Peter Steinberger | 181k | TypeScript (83%) | MIT | ä¸ªäºº AI åŠ©æ‰‹ç½‘å…³ |

### 1.2 æ ¸å¿ƒæ¶æ„å¯¹æ¯”

| ç»´åº¦ | OpenManus | LangGraph | OpenClaw |
|------|-----------|-----------|----------|
| **Agent æ¨¡å¼** | ReAct + ToolCall | çŠ¶æ€å›¾ï¼ˆGraphï¼‰ | Gateway + Lanes |
| **æ‰§è¡Œæµç¨‹** | çº¿æ€§ + åˆ†æ”¯ | DAG çŠ¶æ€æœº | é˜Ÿåˆ—å¹¶å‘ |
| **å¤š Agent** | âœ… Flow æ¨¡å— | âœ… åŸç”Ÿæ”¯æŒ | âš ï¸ Subagent |
| **äººå·¥ä»‹å…¥** | âœ… ask_human | âœ… Human-in-loop | âœ… å®¡æ‰¹é—¨æ§ |
| **ä»£ç é‡** | ~5k è¡Œ | åº“å½¢å¼ | ~40k è¡Œ |

### 1.3 ä¸Šä¸‹æ–‡ç®¡ç†èƒ½åŠ›å¯¹æ¯”

| èƒ½åŠ› | OpenManus | LangGraph | OpenClaw |
|------|-----------|-----------|----------|
| **å¯¹è¯å†å²** | âœ… Memory ç±» | âœ… State ç®¡ç† | âœ… å†…ç½® |
| **çŠ¶æ€æŒä¹…åŒ–** | âŒ æ—  | âœ… **Checkpoint** | âœ… Gateway çŠ¶æ€ |
| **ä¸­æ–­æ¢å¤** | âŒ æ—  | âœ… **åŸç”Ÿæ”¯æŒ** | âš ï¸ æœ‰é™ |
| **é•¿æœŸè®°å¿†** | âŒ éœ€è‡ªå·±åŠ  | âŒ éœ€è‡ªå·±åŠ  | âœ… Markdown æ–‡ä»¶ |
| **RAG/å‘é‡** | âŒ éœ€è‡ªå·±åŠ  | âŒ éœ€è‡ªå·±åŠ  | âŒ éœ€è‡ªå·±åŠ  |

**ç»“è®º**ï¼šLangGraph çš„ Checkpoint æœºåˆ¶æœ€å¼ºï¼Œä½†ä¸‰è€…éƒ½éœ€è¦é¢å¤–é›†æˆä¸“ä¸šè®°å¿†å·¥å…·ï¼ˆå¦‚ Lettaï¼‰ã€‚

### 1.4 Tool/MCP ç®¡ç†èƒ½åŠ›å¯¹æ¯”

| èƒ½åŠ› | OpenManus | LangGraph | OpenClaw |
|------|-----------|-----------|----------|
| **å†…ç½®å·¥å…·æ•°** | 15+ | 0 (éœ€è‡ªå»º) | 100+ AgentSkills |
| **MCP æ”¯æŒ** | âœ… **åŸç”Ÿ** | âš ï¸ éœ€æ¥å…¥ | âœ… æ”¯æŒ |
| **å·¥å…·æ³¨å†Œ** | âœ… tool_collection | âŒ éœ€è‡ªå»º | âœ… ClawHub |
| **åŠ¨æ€åŠ è½½** | âš ï¸ éœ€æ”¹é€  | âš ï¸ éœ€è‡ªå»º | âœ… æ”¯æŒ |
| **æ²™ç®±æ‰§è¡Œ** | âœ… sandbox | âŒ éœ€è‡ªå»º | âš ï¸ æœ‰å®‰å…¨é—®é¢˜ |

**ç»“è®º**ï¼šOpenManus åœ¨å·¥å…·å±‚æ˜æ˜¾é¢†å…ˆï¼ŒMCP åŸç”Ÿæ”¯æŒä¸”å†…ç½®å·¥å…·ä¸°å¯Œã€‚

### 1.5 æ¨¡å‹ç®¡ç†èƒ½åŠ›å¯¹æ¯”

| èƒ½åŠ› | OpenManus | LangGraph | OpenClaw |
|------|-----------|-----------|----------|
| **å¤šæ¨¡å‹é…ç½®** | âœ… config.toml | âœ… å¯é…ç½® | âœ… æ”¯æŒ |
| **æ¨¡å‹è·¯ç”±** | âŒ éœ€è‡ªå·±åŠ  | âŒ éœ€è‡ªå·±åŠ  | âŒ éœ€è‡ªå·±åŠ  |
| **Fallback** | âŒ éœ€è‡ªå·±åŠ  | âŒ éœ€è‡ªå·±åŠ  | âŒ éœ€è‡ªå·±åŠ  |
| **æˆæœ¬æ§åˆ¶** | âŒ éœ€è‡ªå·±åŠ  | âŒ éœ€è‡ªå·±åŠ  | âŒ æŒ‰ API è®¡è´¹ |

**ç»“è®º**ï¼šä¸‰è€…éƒ½éœ€è¦æ¥å…¥ä¸“ä¸šæ¨¡å‹ç½‘å…³ï¼ˆå¦‚ LiteLLMï¼‰è¿›è¡Œå¢å¼ºã€‚

### 1.6 ä¼ä¸šçº§èƒ½åŠ›å¯¹æ¯”

| èƒ½åŠ› | OpenManus | LangGraph | OpenClaw |
|------|-----------|-----------|----------|
| **å¤šç§Ÿæˆ·** | âŒ | âŒ (å¯æ‰©å±•) | âŒ |
| **å®¡è®¡æ—¥å¿—** | âŒ | âœ… **å¯è¿½æº¯** | âš ï¸ æœ‰é™ |
| **åˆè§„æ”¯æŒ** | âŒ | âœ… **EU AI Act** | âŒ |
| **å¯è§‚æµ‹æ€§** | âš ï¸ åŸºç¡€ | âœ… LangSmith é›†æˆ | âš ï¸ åŸºç¡€ |

### 1.7 å¼€å‘æ•ˆç‡å¯¹æ¯”ï¼ˆ1-3 äººå›¢é˜Ÿè§†è§’ï¼‰

| ç»´åº¦ | OpenManus | LangGraph | OpenClaw |
|------|-----------|-----------|----------|
| **å¼€ç®±å³ç”¨** | â­â­â­â­â­ | â­â­ | â­â­â­â­ |
| **ä¸Šæ‰‹æ—¶é—´** | 1-2 å¤© | 1-2 å‘¨ | 2-3 å¤© |
| **MVP æ—¶é—´** | 2-3 å‘¨ | 1-2 æœˆ | 2-3 å‘¨ |
| **äºŒæ¬¡å¼€å‘éš¾åº¦** | â­â­ ä½ | â­â­â­â­ ä¸­é«˜ | â­â­â­ ä¸­ |
| **æ–‡æ¡£è´¨é‡** | â­â­â­ | â­â­â­â­â­ | â­â­â­â­ |

### 1.8 ä¸Šä¸‹æ–‡ç®¡ç†å·¥å…·å¯¹æ¯”

| å·¥å…· | ç±»å‹ | æ ¸å¿ƒèƒ½åŠ› | é€‚ç”¨åœºæ™¯ | æ¨èåº¦ |
|------|------|----------|----------|--------|
| **Letta (MemGPT)** | Agent è®°å¿†æ¡†æ¶ | åˆ†å±‚è®°å¿†ï¼šæ ¸å¿ƒè®°å¿† + å¬å›è®°å¿† + æ¡£æ¡ˆè®°å¿† | Agent é•¿æœŸè®°å¿† | â­â­â­â­â­ |
| **LangGraph Checkpoint** | çŠ¶æ€æŒä¹…åŒ– | çŠ¶æ€å¿«ç…§ã€ä¸­æ–­æ¢å¤ã€å›æ»š | å¤æ‚å·¥ä½œæµ | â­â­â­â­ |
| **EM-LLM** | å­¦æœ¯æ¡†æ¶ | æƒ…èŠ‚å¼è®°å¿†ï¼Œ10M+ token | è¶…é•¿ä¸Šä¸‹æ–‡ | â­â­â­ |
| **LongLMLingua** | Prompt å‹ç¼© | 3-6x å‹ç¼©ç‡ | é™ä½ token æˆæœ¬ | â­â­â­â­ |

### 1.9 æ¨¡å‹ç®¡ç†å·¥å…·å¯¹æ¯”

| å·¥å…· | ç±»å‹ | æ¨¡å‹æ•° | æ ¸å¿ƒèƒ½åŠ› | å®šä»· | æ¨èåº¦ |
|------|------|--------|----------|------|--------|
| **LiteLLM** | å¼€æºç½‘å…³ | 100+ | è·¯ç”±ã€Fallbackã€è´Ÿè½½å‡è¡¡ | å…è´¹ | â­â­â­â­â­ |
| **Portkey AI** | ä¼ä¸šç½‘å…³ | 1600+ | å…¨åŠŸèƒ½ + å¯è§‚æµ‹æ€§ + åˆè§„ | ä»˜è´¹ | â­â­â­â­ |
| **OpenRouter** | ä»£ç†æœåŠ¡ | 200+ | ç»Ÿä¸€ API | æŒ‰é‡ä»˜è´¹ | â­â­â­ |

### 1.10 æœ€ç»ˆé€‰å‹å†³ç­–

| éœ€æ±‚ | é€‰æ‹© | ç†ç”± |
|------|------|------|
| **Agent æ¡†æ¶** | OpenManus | å¼€ç®±å³ç”¨ã€MCP åŸç”Ÿæ”¯æŒã€Python æŠ€æœ¯æ ˆã€ä»£ç è½»é‡æ˜“æ”¹é€  |
| **ä¸Šä¸‹æ–‡ç®¡ç†** | Letta (MemGPT) | ä¸“ä¸šåˆ†å±‚è®°å¿†ã€Agent è‡ªç®¡ç†è®°å¿†ã€å‘é‡å­˜å‚¨åŸç”Ÿæ”¯æŒ |
| **æ¨¡å‹ç®¡ç†** | LiteLLM | å¼€æºå…è´¹ã€100+ æ¨¡å‹ç»Ÿä¸€ APIã€è‡ªæ‰˜ç®¡å¯æ§ |
| **å·¥å…·åè®®** | MCP | è¡Œä¸šæ ‡å‡†ã€å·¥å…·äº’é€šæ€§å¥½ |

### 1.11 é€‰å‹ç»¼åˆè¯„åˆ†

```
                    OpenManus    LangGraph    OpenClaw
å¼€ç®±å³ç”¨            â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆ         â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
å·¥å…·/MCP ç”Ÿæ€       â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆ         â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
ä¸Šä¸‹æ–‡ç®¡ç†          â–ˆâ–ˆâ–ˆâ–ˆ          â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
çŠ¶æ€æŒä¹…åŒ–          â–ˆâ–ˆâ–ˆâ–ˆ          â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
ä¼ä¸šçº§æ‰©å±•          â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
å¼€å‘æ•ˆç‡ (å°å›¢é˜Ÿ)    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆ          â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
```

**æœ€ç»ˆæ¨è**ï¼šOpenManus + Letta + LiteLLM ç»„åˆï¼ŒROI æœ€é«˜ã€‚

---

## 2. é¡¹ç›®æ¦‚è¿°

### 2.1 é¡¹ç›®ç›®æ ‡

æ„å»ºä¸€ä¸ªä¼ä¸šçº§ AI Agent å¹³å°ï¼Œè®©ä¸šåŠ¡äººå‘˜é€šè¿‡è‡ªç„¶è¯­è¨€å®Œæˆå¤æ‚çš„æ•°æ®å¤„ç†ã€åˆ†æå’ŒæŠ¥å‘Šç”Ÿæˆä»»åŠ¡ã€‚

### 2.2 æ ¸å¿ƒèƒ½åŠ›

| èƒ½åŠ› | è¯´æ˜ |
|------|------|
| **è‡ªç„¶è¯­è¨€äº¤äº’** | ç”¨æˆ·é€šè¿‡å¯¹è¯æè¿°éœ€æ±‚ï¼ŒAgent è‡ªåŠ¨ç†è§£å¹¶æ‰§è¡Œ |
| **ä¼ä¸šçŸ¥è¯†åº“** | æ•´åˆä»£ç åº“ã€æ–‡æ¡£ã€æ•°æ®åº“ç»“æ„ç­‰ä¼ä¸šä¸Šä¸‹æ–‡ |
| **è‡ªä¸»ä»»åŠ¡æ‰§è¡Œ** | Plan â†’ Execute â†’ Observe â†’ Replan å¾ªç¯ |
| **è¿‡ç¨‹å¯è§†åŒ–** | å±•ç¤ºæ¯æ­¥æ‰§è¡Œè¿‡ç¨‹å’Œç»“æœ |
| **å¤šåœºæ™¯æ”¯æŒ** | æ•°æ®å¯¼å‡ºã€æŠ¥å‘Šç”Ÿæˆã€æ•°æ®åˆ†æç­‰ |

### 2.3 æŠ€æœ¯é€‰å‹

| å±‚çº§ | é€‰å‹ | ç†ç”± |
|------|------|------|
| **Agent æ¡†æ¶** | OpenManus | Pythonã€MCP åŸç”Ÿæ”¯æŒã€ä»£ç è½»é‡ |
| **ä¸Šä¸‹æ–‡ç®¡ç†** | Letta (MemGPT) | åˆ†å±‚è®°å¿†ã€Agent è‡ªç®¡ç†ã€å‘é‡å­˜å‚¨ |
| **æ¨¡å‹ç®¡ç†** | LiteLLM | å¼€æºã€100+ æ¨¡å‹ã€è·¯ç”±/Fallback |
| **å·¥å…·åè®®** | MCP | è¡Œä¸šæ ‡å‡†ã€å·¥å…·äº’é€š |
| **å‘é‡æ•°æ®åº“** | pgvector | ä¸ PostgreSQL ç»Ÿä¸€ |
| **å‰ç«¯** | Vue 3 | ä¸ç°æœ‰é¡¹ç›®ä¸€è‡´ |

---

## 3. æ•´ä½“æ¶æ„

### 3.1 ç³»ç»Ÿæ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              ç”¨æˆ·å±‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                      Web å‰ç«¯ (Vue 3)                            â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚ å¯¹è¯ç•Œé¢  â”‚  â”‚ ä»»åŠ¡é¢æ¿  â”‚  â”‚ ç»“æœå±•ç¤º  â”‚  â”‚ ç®¡ç†åå°         â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                              ç½‘å…³å±‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    API Gateway (FastAPI)                         â”‚   â”‚
â”‚  â”‚  - è®¤è¯é‰´æƒ (JWT)                                                â”‚   â”‚
â”‚  â”‚  - è¯·æ±‚è·¯ç”±                                                      â”‚   â”‚
â”‚  â”‚  - WebSocket è¿æ¥ç®¡ç†                                            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                             Agent å±‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    OpenManus Agent Core                          â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚   â”‚
â”‚  â”‚   â”‚ Planner â”‚ â†’  â”‚Executor â”‚ â†’  â”‚Observer â”‚ â†’  â”‚Replannerâ”‚     â”‚   â”‚
â”‚  â”‚   â”‚  è§„åˆ’å™¨  â”‚    â”‚  æ‰§è¡Œå™¨  â”‚    â”‚  è§‚å¯Ÿå™¨  â”‚    â”‚ é‡è§„åˆ’å™¨ â”‚     â”‚   â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚   â”‚
â”‚  â”‚        â†‘                                              â”‚          â”‚   â”‚
â”‚  â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                             èƒ½åŠ›å±‚                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  ä¸Šä¸‹æ–‡ç®¡ç†    â”‚  â”‚   æ¨¡å‹ç®¡ç†     â”‚  â”‚     Tool/Skill ç®¡ç†       â”‚   â”‚
â”‚  â”‚   (Letta)     â”‚  â”‚  (LiteLLM)    â”‚  â”‚        (MCP)             â”‚   â”‚
â”‚  â”‚               â”‚  â”‚               â”‚  â”‚                           â”‚   â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚ â”‚Core Memoryâ”‚ â”‚  â”‚ â”‚Model Routerâ”‚ â”‚  â”‚ â”‚   Tool Registry     â”‚  â”‚   â”‚
â”‚  â”‚ â”‚ æ ¸å¿ƒè®°å¿†   â”‚ â”‚  â”‚ â”‚ æ¨¡å‹è·¯ç”±   â”‚ â”‚  â”‚ â”‚   å·¥å…·æ³¨å†Œè¡¨         â”‚  â”‚   â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚ â”‚Recall Mem â”‚ â”‚  â”‚ â”‚ Fallback  â”‚ â”‚  â”‚ â”‚   MCP Servers       â”‚  â”‚   â”‚
â”‚  â”‚ â”‚ å¬å›è®°å¿†   â”‚ â”‚  â”‚ â”‚ æ•…éšœè½¬ç§»   â”‚ â”‚  â”‚ â”‚   MCP æœåŠ¡ç«¯        â”‚  â”‚   â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚ â”‚Archival   â”‚ â”‚  â”‚ â”‚Cost Track â”‚ â”‚  â”‚ â”‚   Skill Library     â”‚  â”‚   â”‚
â”‚  â”‚ â”‚ æ¡£æ¡ˆè®°å¿†   â”‚ â”‚  â”‚ â”‚ æˆæœ¬è¿½è¸ª   â”‚ â”‚  â”‚ â”‚   æŠ€èƒ½åº“            â”‚  â”‚   â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                             æ‰§è¡Œå±‚                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ä»£ç æ‰§è¡Œ   â”‚ â”‚æ•°æ®åº“æŸ¥è¯¢ â”‚ â”‚æ–‡ä»¶æ“ä½œ   â”‚ â”‚API è°ƒç”¨   â”‚ â”‚æµè§ˆå™¨è‡ªåŠ¨åŒ–   â”‚  â”‚
â”‚  â”‚(Sandbox) â”‚ â”‚(SQL)     â”‚ â”‚(File)    â”‚ â”‚(HTTP)    â”‚ â”‚(Playwright)  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                             æ•°æ®å±‚                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  PostgreSQL  â”‚  â”‚   pgvector   â”‚  â”‚    Redis     â”‚  â”‚    MinIO   â”‚  â”‚
â”‚  â”‚  ä¸šåŠ¡æ•°æ®     â”‚  â”‚  å‘é‡å­˜å‚¨     â”‚  â”‚  ç¼“å­˜/é˜Ÿåˆ—    â”‚  â”‚  æ–‡ä»¶å­˜å‚¨   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                           ä¼ä¸šçŸ¥è¯†æº                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ä»£ç ä»“åº“  â”‚ â”‚ é£ä¹¦æ–‡æ¡£  â”‚ â”‚ æ•°æ®åº“   â”‚ â”‚ æ ‡æ³¨æ•°æ®  â”‚ â”‚ ä¼šè®®è§†é¢‘     â”‚  â”‚
â”‚  â”‚  (Git)   â”‚ â”‚ (Feishu) â”‚ â”‚(Schema) â”‚ â”‚ (JSON)   â”‚ â”‚(Transcript) â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 æ•°æ®æµæ¶æ„

```
ç”¨æˆ·è¾“å…¥
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        1. æ„å›¾ç†è§£                               â”‚
â”‚  - è§£æç”¨æˆ·è‡ªç„¶è¯­è¨€                                              â”‚
â”‚  - è¯†åˆ«ä»»åŠ¡ç±»å‹ï¼ˆæ•°æ®å¯¼å‡º/æŠ¥å‘Šç”Ÿæˆ/æ•°æ®åˆ†æç­‰ï¼‰                    â”‚
â”‚  - æå–å…³é”®å‚æ•°                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        2. ä¸Šä¸‹æ–‡æ£€ç´¢                             â”‚
â”‚  - ä» Letta æ ¸å¿ƒè®°å¿†è·å–ç”¨æˆ·ç”»åƒå’Œåå¥½                           â”‚
â”‚  - ä»å‘é‡åº“æ£€ç´¢ç›¸å…³ä¼ä¸šçŸ¥è¯†ï¼ˆæ–‡æ¡£ã€ä»£ç ã€æ•°æ®ç»“æ„ï¼‰                â”‚
â”‚  - æ„å»ºå¢å¼º Prompt                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        3. ä»»åŠ¡è§„åˆ’                               â”‚
â”‚  - LLM ç”Ÿæˆæ‰§è¡Œè®¡åˆ’                                              â”‚
â”‚  - åˆ†è§£ä¸ºå¤šä¸ªå­ä»»åŠ¡                                              â”‚
â”‚  - ç¡®å®šå·¥å…·è°ƒç”¨é¡ºåº                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        4. å¾ªç¯æ‰§è¡Œ                               â”‚
â”‚                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚   â”‚ æ‰§è¡Œæ­¥éª¤  â”‚ â†’  â”‚ è§‚å¯Ÿç»“æœ  â”‚ â†’  â”‚ åˆ¤æ–­ç»§ç»­  â”‚                  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚        â”‚                               â”‚                         â”‚
â”‚        â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚                         â”‚
â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ é‡æ–°è§„åˆ’  â”‚â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚
â”‚                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                    â”‚
â”‚                                                                  â”‚
â”‚   æ¯æ­¥æ‰§è¡Œç»“æœå®æ—¶æ¨é€åˆ°å‰ç«¯                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        5. ç»“æœè¾“å‡º                               â”‚
â”‚  - æ±‡æ€»æ‰€æœ‰æ­¥éª¤ç»“æœ                                              â”‚
â”‚  - ç”Ÿæˆæœ€ç»ˆè¾“å‡ºï¼ˆæŠ¥å‘Š/å›¾è¡¨/æ–‡ä»¶ï¼‰                                 â”‚
â”‚  - æ›´æ–°è®°å¿†ï¼ˆè®°ä½æœ¬æ¬¡äº¤äº’ï¼‰                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
ç”¨æˆ·è·å¾—ç»“æœ + å®Œæ•´æ‰§è¡Œè¿‡ç¨‹
```

---

## 4. å¤§æ¨¡å‹è°ƒç”¨ç¯èŠ‚è¯´æ˜

åœ¨æ•´ä¸ª Agent æ‰§è¡Œæµç¨‹ä¸­ï¼Œä»¥ä¸‹ç¯èŠ‚éœ€è¦è°ƒç”¨å¤§æ¨¡å‹ï¼ˆLLMï¼‰ã€‚è¿™æ˜¯ç†è§£ç³»ç»Ÿæˆæœ¬å’Œæ€§èƒ½çš„å…³é”®ã€‚

### 4.1 å¤§æ¨¡å‹è°ƒç”¨å…¨æ™¯å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        å¤§æ¨¡å‹è°ƒç”¨ç¯èŠ‚ä¸€è§ˆ                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚   ç”¨æˆ·è¾“å…¥: "å¸®æˆ‘å¯¼å‡ºä¸Šå‘¨æ ‡æ³¨æ•°æ®ï¼Œç”Ÿæˆåˆ†ææŠ¥å‘Š"                           â”‚
â”‚                                                                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ ğŸ¤– LLM è°ƒç”¨ 1: æ„å›¾ç†è§£                                          â”‚   â”‚
â”‚   â”‚    æ¨¡å‹: fast-task (DeepSeek)                                    â”‚   â”‚
â”‚   â”‚    è¾“å…¥: ç”¨æˆ·åŸå§‹è¾“å…¥                                             â”‚   â”‚
â”‚   â”‚    è¾“å‡º: ä»»åŠ¡ç±»å‹ã€å…³é”®å‚æ•°                                       â”‚   â”‚
â”‚   â”‚    Token: ~500 input / ~200 output                               â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â†“                                           â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ ğŸ” Embedding è°ƒç”¨: ä¸Šä¸‹æ–‡æ£€ç´¢                                     â”‚   â”‚
â”‚   â”‚    æ¨¡å‹: text-embedding-3-small                                  â”‚   â”‚
â”‚   â”‚    è¾“å…¥: ç”¨æˆ·è¾“å…¥ + å…³é”®è¯                                        â”‚   â”‚
â”‚   â”‚    è¾“å‡º: å‘é‡è¡¨ç¤º (ç”¨äºç›¸ä¼¼åº¦æœç´¢)                                â”‚   â”‚
â”‚   â”‚    Token: ~100 input                                             â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â†“                                           â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ ğŸ¤– LLM è°ƒç”¨ 2: ä»»åŠ¡è§„åˆ’                                          â”‚   â”‚
â”‚   â”‚    æ¨¡å‹: main-reasoning (Claude/GPT-4o)                          â”‚   â”‚
â”‚   â”‚    è¾“å…¥: ç”¨æˆ·è¾“å…¥ + æ£€ç´¢åˆ°çš„ä¸Šä¸‹æ–‡ + å¯ç”¨å·¥å…·åˆ—è¡¨                  â”‚   â”‚
â”‚   â”‚    è¾“å‡º: æ‰§è¡Œè®¡åˆ’ (JSON æ ¼å¼çš„æ­¥éª¤åˆ—è¡¨)                           â”‚   â”‚
â”‚   â”‚    Token: ~2000 input / ~500 output                              â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â†“                                           â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ ğŸ¤– LLM è°ƒç”¨ 3-N: å¾ªç¯æ‰§è¡Œ (æ¯ä¸ªæ­¥éª¤)                              â”‚   â”‚
â”‚   â”‚                                                                   â”‚   â”‚
â”‚   â”‚    Step 3: å·¥å…·é€‰æ‹©ä¸å‚æ•°ç”Ÿæˆ                                     â”‚   â”‚
â”‚   â”‚       æ¨¡å‹: main-reasoning                                        â”‚   â”‚
â”‚   â”‚       è¾“å…¥: å½“å‰æ­¥éª¤ + ä¸Šä¸‹æ–‡ + å·¥å…·å®šä¹‰                          â”‚   â”‚
â”‚   â”‚       è¾“å‡º: å·¥å…·åç§° + å‚æ•°                                       â”‚   â”‚
â”‚   â”‚       Token: ~1500 input / ~300 output                           â”‚   â”‚
â”‚   â”‚                                                                   â”‚   â”‚
â”‚   â”‚    Step 4: ç»“æœè§‚å¯Ÿä¸åˆ¤æ–­                                         â”‚   â”‚
â”‚   â”‚       æ¨¡å‹: fast-task                                             â”‚   â”‚
â”‚   â”‚       è¾“å…¥: å·¥å…·æ‰§è¡Œç»“æœ                                          â”‚   â”‚
â”‚   â”‚       è¾“å‡º: æˆåŠŸ/å¤±è´¥åˆ¤æ–­ + ä¸‹ä¸€æ­¥å»ºè®®                            â”‚   â”‚
â”‚   â”‚       Token: ~800 input / ~200 output                            â”‚   â”‚
â”‚   â”‚                                                                   â”‚   â”‚
â”‚   â”‚    Step 5: (å¯é€‰) é‡æ–°è§„åˆ’                                        â”‚   â”‚
â”‚   â”‚       æ¨¡å‹: main-reasoning                                        â”‚   â”‚
â”‚   â”‚       è¾“å…¥: åŸè®¡åˆ’ + æ‰§è¡Œç»“æœ + å¤±è´¥åŸå›                           â”‚   â”‚
â”‚   â”‚       è¾“å‡º: æ–°çš„æ‰§è¡Œè®¡åˆ’                                          â”‚   â”‚
â”‚   â”‚       Token: ~2000 input / ~500 output                           â”‚   â”‚
â”‚   â”‚                                                                   â”‚   â”‚
â”‚   â”‚    ... é‡å¤ Step 3-5 ç›´åˆ°å®Œæˆ ...                                 â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â†“                                           â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ ğŸ¤– LLM è°ƒç”¨ N+1: ç»“æœæ±‡æ€»                                        â”‚   â”‚
â”‚   â”‚    æ¨¡å‹: main-reasoning                                          â”‚   â”‚
â”‚   â”‚    è¾“å…¥: æ‰€æœ‰æ­¥éª¤æ‰§è¡Œç»“æœ                                         â”‚   â”‚
â”‚   â”‚    è¾“å‡º: æœ€ç»ˆç­”æ¡ˆ + æ€»ç»“è¯´æ˜                                      â”‚   â”‚
â”‚   â”‚    Token: ~3000 input / ~1000 output                             â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â†“                                           â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ ğŸ” Embedding è°ƒç”¨: è®°å¿†æ›´æ–°                                       â”‚   â”‚
â”‚   â”‚    æ¨¡å‹: text-embedding-3-small                                  â”‚   â”‚
â”‚   â”‚    è¾“å…¥: æœ¬æ¬¡å¯¹è¯å†…å®¹                                             â”‚   â”‚
â”‚   â”‚    è¾“å‡º: å‘é‡è¡¨ç¤º (å­˜å…¥é•¿æœŸè®°å¿†)                                  â”‚   â”‚
â”‚   â”‚    Token: ~500 input                                             â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 å„ç¯èŠ‚å¤§æ¨¡å‹è°ƒç”¨è¯¦è§£

| ç¯èŠ‚ | è°ƒç”¨ç±»å‹ | æ¨èæ¨¡å‹ | è¾“å…¥å†…å®¹ | è¾“å‡ºå†…å®¹ | é¢„ä¼° Token |
|------|----------|----------|----------|----------|------------|
| **æ„å›¾ç†è§£** | LLM | DeepSeek (fast) | ç”¨æˆ·åŸå§‹è¾“å…¥ | ä»»åŠ¡ç±»å‹ã€å‚æ•° | 500/200 |
| **ä¸Šä¸‹æ–‡æ£€ç´¢** | Embedding | text-embedding-3-small | æŸ¥è¯¢æ–‡æœ¬ | å‘é‡ | 100/- |
| **ä»»åŠ¡è§„åˆ’** | LLM | Claude/GPT-4o (main) | è¾“å…¥+ä¸Šä¸‹æ–‡+å·¥å…· | æ‰§è¡Œè®¡åˆ’ JSON | 2000/500 |
| **å·¥å…·é€‰æ‹©** | LLM | Claude/GPT-4o (main) | æ­¥éª¤+ä¸Šä¸‹æ–‡+å·¥å…·å®šä¹‰ | å·¥å…·+å‚æ•° | 1500/300 |
| **ç»“æœè§‚å¯Ÿ** | LLM | DeepSeek (fast) | æ‰§è¡Œç»“æœ | åˆ¤æ–­+å»ºè®® | 800/200 |
| **é‡æ–°è§„åˆ’** | LLM | Claude/GPT-4o (main) | åŸè®¡åˆ’+ç»“æœ+åŸå›  | æ–°è®¡åˆ’ | 2000/500 |
| **ä»£ç ç”Ÿæˆ** | LLM | DeepSeek Coder | ä»»åŠ¡æè¿° | Python ä»£ç  | 1000/500 |
| **æŠ¥å‘Šç”Ÿæˆ** | LLM | Claude/GPT-4o (main) | æ•°æ®+æ¨¡æ¿ | æŠ¥å‘Šå†…å®¹ | 3000/2000 |
| **ç»“æœæ±‡æ€»** | LLM | Claude/GPT-4o (main) | æ‰€æœ‰æ­¥éª¤ç»“æœ | æœ€ç»ˆç­”æ¡ˆ | 3000/1000 |
| **è®°å¿†æ›´æ–°** | Embedding | text-embedding-3-small | å¯¹è¯å†…å®¹ | å‘é‡ | 500/- |

### 4.3 åœºæ™¯ Token æ¶ˆè€—ä¼°ç®—

#### åœºæ™¯ä¸€ï¼šæ•°æ®å¯¼å‡ºä¸åˆ†ææŠ¥å‘Š

```
ç¯èŠ‚                          è¾“å…¥ Token    è¾“å‡º Token    æ¨¡å‹              æˆæœ¬ä¼°ç®—
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. æ„å›¾ç†è§£                      500          200        DeepSeek          $0.0001
2. ä¸Šä¸‹æ–‡æ£€ç´¢ (Embedding)        100            -        Embedding         $0.00001
3. ä»»åŠ¡è§„åˆ’                    2,000          500        Claude            $0.0135
4. å·¥å…·è°ƒç”¨ x5 (å¹³å‡)          7,500        1,500        Claude            $0.045
5. ç»“æœè§‚å¯Ÿ x5                 4,000        1,000        DeepSeek          $0.0005
6. ä»£ç ç”Ÿæˆ (æ•°æ®åˆ†æ)         1,000          500        DeepSeek Coder    $0.0002
7. æŠ¥å‘Šç”Ÿæˆ                    3,000        2,000        Claude            $0.039
8. ç»“æœæ±‡æ€»                    3,000        1,000        Claude            $0.024
9. è®°å¿†æ›´æ–° (Embedding)          500            -        Embedding         $0.00005
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
æ€»è®¡                          21,600        6,700                          ~$0.12
```

#### åœºæ™¯äºŒï¼šä¸ªäººå‘¨æŠ¥ç”Ÿæˆ

```
ç¯èŠ‚                          è¾“å…¥ Token    è¾“å‡º Token    æ¨¡å‹              æˆæœ¬ä¼°ç®—
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. æ„å›¾ç†è§£                      300          150        DeepSeek          $0.00005
2. ä¸Šä¸‹æ–‡æ£€ç´¢ (Embedding)        100            -        Embedding         $0.00001
3. ä»»åŠ¡è§„åˆ’                    1,500          400        Claude            $0.0105
4. å·¥å…·è°ƒç”¨ x4 (å¹³å‡)          5,000        1,000        Claude            $0.03
5. ç»“æœè§‚å¯Ÿ x4                 3,000          800        DeepSeek          $0.0004
6. æŠ¥å‘Šç”Ÿæˆ                    2,000        1,500        Claude            $0.027
7. ç»“æœæ±‡æ€»                    2,000          800        Claude            $0.018
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
æ€»è®¡                          13,900        4,650                          ~$0.09
```

#### åœºæ™¯ä¸‰ï¼šæ‰¹é‡è¯„æµ‹ç»“æœå¤„ç†

```
ç¯èŠ‚                          è¾“å…¥ Token    è¾“å‡º Token    æ¨¡å‹              æˆæœ¬ä¼°ç®—
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. æ„å›¾ç†è§£                      400          200        DeepSeek          $0.00006
2. ä¸Šä¸‹æ–‡æ£€ç´¢ (Embedding)        100            -        Embedding         $0.00001
3. ä»»åŠ¡è§„åˆ’                    1,800          500        Claude            $0.0129
4. å·¥å…·è°ƒç”¨ x6 (å¹³å‡)          8,000        1,800        Claude            $0.051
5. ç»“æœè§‚å¯Ÿ x6                 5,000        1,200        DeepSeek          $0.0006
6. ä»£ç ç”Ÿæˆ (ç»Ÿè®¡åˆ†æ)         1,200          600        DeepSeek Coder    $0.0002
7. å›¾è¡¨æè¿°ç”Ÿæˆ                1,000          500        Claude            $0.0105
8. æŠ¥å‘Šç”Ÿæˆ                    3,500        2,500        Claude            $0.048
9. ç»“æœæ±‡æ€»                    3,000        1,000        Claude            $0.024
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
æ€»è®¡                          24,000        8,300                          ~$0.15
```

### 4.4 æ¨¡å‹é€‰æ‹©ç­–ç•¥

```python
# model/task_router.py

TASK_MODEL_MAPPING = {
    # å¤æ‚æ¨ç†ä»»åŠ¡ â†’ ä¸»åŠ›æ¨¡å‹
    "intent_understanding": "fast-task",      # æ„å›¾ç†è§£ç”¨å¿«é€Ÿæ¨¡å‹å³å¯
    "task_planning": "main-reasoning",        # ä»»åŠ¡è§„åˆ’éœ€è¦å¼ºæ¨ç†
    "tool_selection": "main-reasoning",       # å·¥å…·é€‰æ‹©éœ€è¦ç†è§£å·¥å…·èƒ½åŠ›
    "result_observation": "fast-task",        # ç»“æœè§‚å¯Ÿç›¸å¯¹ç®€å•
    "replanning": "main-reasoning",           # é‡è§„åˆ’éœ€è¦å¼ºæ¨ç†
    "report_generation": "main-reasoning",    # æŠ¥å‘Šç”Ÿæˆéœ€è¦å¥½çš„æ–‡å­—èƒ½åŠ›
    "result_summary": "main-reasoning",       # ç»“æœæ±‡æ€»éœ€è¦ç»¼åˆèƒ½åŠ›
    
    # ä»£ç ä»»åŠ¡ â†’ ä»£ç æ¨¡å‹
    "code_generation": "code-gen",            # ä»£ç ç”Ÿæˆç”¨ä¸“é—¨æ¨¡å‹
    "sql_generation": "code-gen",             # SQL ç”Ÿæˆç”¨ä»£ç æ¨¡å‹
    
    # å‘é‡åŒ–ä»»åŠ¡ â†’ Embedding æ¨¡å‹
    "context_retrieval": "embedding",         # ä¸Šä¸‹æ–‡æ£€ç´¢
    "memory_update": "embedding",             # è®°å¿†æ›´æ–°
}

# æˆæœ¬ä¼˜åŒ–ç­–ç•¥
COST_OPTIMIZATION = {
    # å½“ä»»åŠ¡ç®€å•æ—¶ï¼Œé™çº§ä½¿ç”¨ä¾¿å®œæ¨¡å‹
    "simple_intent": "fast-task",             # ç®€å•æ„å›¾ç›´æ¥ç”¨å¿«é€Ÿæ¨¡å‹
    "cached_response": None,                  # æœ‰ç¼“å­˜æ—¶ä¸è°ƒç”¨æ¨¡å‹
    "template_based": "fast-task",            # æ¨¡æ¿ç±»ä»»åŠ¡ç”¨å¿«é€Ÿæ¨¡å‹
}
```

### 4.5 ä¸è°ƒç”¨å¤§æ¨¡å‹çš„ç¯èŠ‚

ä»¥ä¸‹ç¯èŠ‚**ä¸éœ€è¦**è°ƒç”¨å¤§æ¨¡å‹ï¼Œè€Œæ˜¯ç›´æ¥æ‰§è¡Œï¼š

| ç¯èŠ‚ | æ‰§è¡Œæ–¹å¼ | è¯´æ˜ |
|------|----------|------|
| **SQL æ‰§è¡Œ** | ç›´æ¥æ‰§è¡Œ | å·¥å…·ç›´æ¥è°ƒç”¨æ•°æ®åº“ |
| **æ–‡ä»¶è¯»å†™** | ç›´æ¥æ‰§è¡Œ | å·¥å…·ç›´æ¥æ“ä½œæ–‡ä»¶ç³»ç»Ÿ |
| **API è°ƒç”¨** | ç›´æ¥æ‰§è¡Œ | å·¥å…·ç›´æ¥è°ƒç”¨å¤–éƒ¨ API |
| **å›¾è¡¨æ¸²æŸ“** | ç›´æ¥æ‰§è¡Œ | matplotlib/echarts æ¸²æŸ“ |
| **æ•°æ®å¯¼å‡º** | ç›´æ¥æ‰§è¡Œ | pandas å¯¼å‡º CSV/Excel |
| **å‘é‡æœç´¢** | ç›´æ¥æ‰§è¡Œ | pgvector ç›¸ä¼¼åº¦æœç´¢ |
| **ç¼“å­˜æŸ¥è¯¢** | ç›´æ¥æ‰§è¡Œ | Redis ç¼“å­˜å‘½ä¸­ç›´æ¥è¿”å› |

### 4.6 Token ä¼˜åŒ–ç­–ç•¥

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Token ä¼˜åŒ–ç­–ç•¥                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  1. ä¸Šä¸‹æ–‡å‹ç¼©                                                   â”‚
â”‚     - ä½¿ç”¨ LongLMLingua å‹ç¼©é•¿æ–‡æœ¬ (3-6x å‹ç¼©ç‡)                 â”‚
â”‚     - åªæ£€ç´¢æœ€ç›¸å…³çš„ Top-K æ–‡æ¡£                                  â”‚
â”‚     - å¯¹å†å²å¯¹è¯è¿›è¡Œæ‘˜è¦è€Œéå…¨é‡ä¼ å…¥                             â”‚
â”‚                                                                  â”‚
â”‚  2. æ¨¡å‹é™çº§                                                     â”‚
â”‚     - ç®€å•ä»»åŠ¡ä½¿ç”¨ä¾¿å®œæ¨¡å‹ (DeepSeek)                            â”‚
â”‚     - åªåœ¨å…³é”®å†³ç­–ç‚¹ä½¿ç”¨å¼ºæ¨¡å‹ (Claude/GPT-4o)                   â”‚
â”‚                                                                  â”‚
â”‚  3. ç¼“å­˜å¤ç”¨                                                     â”‚
â”‚     - ç›¸ä¼¼é—®é¢˜çš„æ‰§è¡Œè®¡åˆ’ç¼“å­˜                                     â”‚
â”‚     - å¸¸ç”¨å·¥å…·å‚æ•°æ¨¡æ¿ç¼“å­˜                                       â”‚
â”‚     - Embedding ç»“æœç¼“å­˜                                         â”‚
â”‚                                                                  â”‚
â”‚  4. å¹¶è¡Œå¤„ç†                                                     â”‚
â”‚     - ç‹¬ç«‹æ­¥éª¤å¹¶è¡Œæ‰§è¡Œ                                           â”‚
â”‚     - å‡å°‘æ€»ä½“ç­‰å¾…æ—¶é—´                                           â”‚
â”‚                                                                  â”‚
â”‚  5. æå‰ç»ˆæ­¢                                                     â”‚
â”‚     - æ£€æµ‹åˆ°é”™è¯¯ç«‹å³åœæ­¢                                         â”‚
â”‚     - è¾¾åˆ°ç›®æ ‡åä¸ç»§ç»­å¤šä½™æ­¥éª¤                                   â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 5. æ ¸å¿ƒç»„ä»¶è¯¦è§£

### 5.1 Agent Coreï¼ˆåŸºäº OpenManusï¼‰

```python
# agent/enterprise_agent.py
from app.agent.manus import Manus
from app.tool.tool_collection import ToolCollection
from letta import create_client
from litellm import completion

class EnterpriseAgent(Manus):
    """ä¼ä¸šçº§ Agentï¼Œé›†æˆ Letta è®°å¿†å’Œ LiteLLM æ¨¡å‹ç®¡ç†"""
    
    def __init__(self, tenant_id: str, user_id: str):
        super().__init__()
        self.tenant_id = tenant_id
        self.user_id = user_id
        
        # åˆå§‹åŒ– Letta è®°å¿†ç³»ç»Ÿ
        self.letta_client = create_client()
        self.memory_agent = self._init_memory_agent()
        
        # åˆå§‹åŒ–å·¥å…·é›†
        self.tools = self._load_tenant_tools()
        
        # æ‰§è¡Œå†å²ï¼ˆç”¨äºè¿‡ç¨‹å±•ç¤ºï¼‰
        self.execution_history = []
    
    def _init_memory_agent(self):
        """åˆå§‹åŒ– Letta è®°å¿† Agent"""
        # åŠ è½½ç”¨æˆ·ç”»åƒ
        user_profile = self._load_user_profile()
        
        return self.letta_client.create_agent(
            name=f"enterprise_agent_{self.user_id}",
            memory=ChatMemory(
                persona=self._get_system_persona(),
                human=user_profile
            ),
            embedding_config=EmbeddingConfig(
                embedding_endpoint_type="openai",
                embedding_model="text-embedding-3-small"
            )
        )
    
    async def execute_task(self, user_input: str, websocket=None):
        """æ‰§è¡Œç”¨æˆ·ä»»åŠ¡ï¼Œè¿”å›è¿‡ç¨‹å’Œç»“æœ"""
        
        # 1. æ£€ç´¢ç›¸å…³ä¸Šä¸‹æ–‡
        context = await self._retrieve_context(user_input)
        
        # 2. ç”Ÿæˆæ‰§è¡Œè®¡åˆ’
        plan = await self._generate_plan(user_input, context)
        await self._emit_step(websocket, "plan", plan)
        
        # 3. å¾ªç¯æ‰§è¡Œ
        for step in plan.steps:
            # æ‰§è¡Œæ­¥éª¤
            result = await self._execute_step(step)
            
            # è®°å½•å†å²
            self.execution_history.append({
                "step": step,
                "result": result,
                "timestamp": datetime.utcnow()
            })
            
            # å®æ—¶æ¨é€
            await self._emit_step(websocket, "execution", {
                "step": step,
                "result": result
            })
            
            # åˆ¤æ–­æ˜¯å¦éœ€è¦é‡æ–°è§„åˆ’
            if self._need_replan(result):
                plan = await self._replan(plan, result)
                await self._emit_step(websocket, "replan", plan)
        
        # 4. ç”Ÿæˆæœ€ç»ˆç»“æœ
        final_result = await self._generate_final_result()
        
        # 5. æ›´æ–°è®°å¿†
        await self._update_memory(user_input, final_result)
        
        return {
            "result": final_result,
            "execution_history": self.execution_history
        }
```

### 5.2 æ‰§è¡Œæ­¥éª¤æ¨é€ï¼ˆWebSocketï¼‰

```python
# api/websocket.py
from fastapi import WebSocket
import json

class AgentWebSocket:
    """Agent æ‰§è¡Œè¿‡ç¨‹çš„ WebSocket æ¨é€"""
    
    def __init__(self, websocket: WebSocket):
        self.websocket = websocket
    
    async def emit(self, event_type: str, data: dict):
        """æ¨é€æ‰§è¡Œäº‹ä»¶åˆ°å‰ç«¯"""
        await self.websocket.send_json({
            "type": event_type,
            "data": data,
            "timestamp": datetime.utcnow().isoformat()
        })

# äº‹ä»¶ç±»å‹è¯´æ˜
EVENT_TYPES = {
    "plan": "ä»»åŠ¡è§„åˆ’å®Œæˆ",
    "thinking": "Agent æ­£åœ¨æ€è€ƒ",
    "tool_call": "è°ƒç”¨å·¥å…·",
    "tool_result": "å·¥å…·æ‰§è¡Œç»“æœ",
    "observation": "è§‚å¯Ÿåˆ†æ",
    "replan": "é‡æ–°è§„åˆ’",
    "progress": "æ‰§è¡Œè¿›åº¦",
    "final": "æœ€ç»ˆç»“æœ",
    "error": "æ‰§è¡Œé”™è¯¯"
}
```

---

## 6. ä¸Šä¸‹æ–‡ç®¡ç†è®¾è®¡

### 6.1 Letta è®°å¿†æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Letta è®°å¿†ç³»ç»Ÿ                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                   Core Memory (æ ¸å¿ƒè®°å¿†)                   â”‚  â”‚
â”‚  â”‚                   ï½2000 tokens                            â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚ System Persona (ç³»ç»Ÿäººè®¾)                            â”‚  â”‚  â”‚
â”‚  â”‚  â”‚ - ä½ æ˜¯ä¼ä¸šæ•°æ®åˆ†æåŠ©æ‰‹                                â”‚  â”‚  â”‚
â”‚  â”‚  â”‚ - æ“…é•¿æ•°æ®å¤„ç†ã€æŠ¥å‘Šç”Ÿæˆã€SQL æŸ¥è¯¢                    â”‚  â”‚  â”‚
â”‚  â”‚  â”‚ - ç†Ÿæ‚‰å…¬å¸ä¸šåŠ¡å’Œæ•°æ®ç»“æ„                              â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚ User Profile (ç”¨æˆ·ç”»åƒ)                              â”‚  â”‚  â”‚
â”‚  â”‚  â”‚ - å§“å: å¼ ä¸‰                                         â”‚  â”‚  â”‚
â”‚  â”‚  â”‚ - éƒ¨é—¨: æ•°æ®è¿è¥éƒ¨                                   â”‚  â”‚  â”‚
â”‚  â”‚  â”‚ - åå¥½: å–œæ¬¢è¯¦ç»†çš„åˆ†ææŠ¥å‘Šï¼Œå¸¸ç”¨ Excel æ ¼å¼           â”‚  â”‚  â”‚
â”‚  â”‚  â”‚ - å¸¸ç”¨æ•°æ®: æ ‡æ³¨æ•°æ®ã€ç”¨æˆ·è¡Œä¸ºæ•°æ®                    â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                              â†“                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                  Recall Memory (å¬å›è®°å¿†)                  â”‚  â”‚
â”‚  â”‚                  å†å²å¯¹è¯å­˜æ¡£ï¼Œå¯æœç´¢                       â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  conversation_search("ä¸Šå‘¨çš„æ•°æ®å¯¼å‡º")                     â”‚  â”‚
â”‚  â”‚  â†’ è¿”å›ç›¸å…³å†å²å¯¹è¯ç‰‡æ®µ                                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                              â†“                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                Archival Memory (æ¡£æ¡ˆè®°å¿†)                  â”‚  â”‚
â”‚  â”‚                é•¿æœŸçŸ¥è¯†å­˜å‚¨ (pgvector)                      â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚ ä¼ä¸šçŸ¥è¯†åº“                                           â”‚  â”‚  â”‚
â”‚  â”‚  â”‚ - ä»£ç ä»“åº“æ–‡æ¡£ (README, æ³¨é‡Š)                        â”‚  â”‚  â”‚
â”‚  â”‚  â”‚ - é£ä¹¦æ–‡æ¡£ (äº§å“æ–‡æ¡£, æŠ€æœ¯è§„èŒƒ)                       â”‚  â”‚  â”‚
â”‚  â”‚  â”‚ - æ•°æ®åº“è¡¨ç»“æ„è¯´æ˜                                   â”‚  â”‚  â”‚
â”‚  â”‚  â”‚ - æ ‡æ³¨è§„èŒƒå’Œç¤ºä¾‹                                     â”‚  â”‚  â”‚
â”‚  â”‚  â”‚ - ä¼šè®®çºªè¦                                           â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  archival_memory_search("ç”¨æˆ·æ ‡æ³¨æ•°æ®è¡¨ç»“æ„")             â”‚  â”‚
â”‚  â”‚  â†’ è¿”å›ç›¸å…³æ•°æ®åº“è¡¨å®šä¹‰å’Œå­—æ®µè¯´æ˜                          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2 ä¼ä¸šçŸ¥è¯†å¯¼å…¥æµç¨‹

```python
# context/knowledge_importer.py

class EnterpriseKnowledgeImporter:
    """ä¼ä¸šçŸ¥è¯†å¯¼å…¥å™¨"""
    
    def __init__(self, letta_client, tenant_id: str):
        self.letta_client = letta_client
        self.tenant_id = tenant_id
    
    async def import_codebase(self, repo_path: str):
        """å¯¼å…¥ä»£ç ä»“åº“"""
        for file_path in self._scan_code_files(repo_path):
            content = self._read_file(file_path)
            
            # åˆ†å—å¤„ç†å¤§æ–‡ä»¶
            chunks = self._chunk_content(content, max_tokens=500)
            
            for chunk in chunks:
                await self.letta_client.insert_archival_memory(
                    agent_id=self.agent_id,
                    text=chunk,
                    metadata={
                        "type": "code",
                        "file_path": file_path,
                        "tenant_id": self.tenant_id
                    }
                )
    
    async def import_feishu_docs(self, doc_ids: list):
        """å¯¼å…¥é£ä¹¦æ–‡æ¡£"""
        feishu_client = FeishuClient()
        
        for doc_id in doc_ids:
            doc = await feishu_client.get_document(doc_id)
            
            await self.letta_client.insert_archival_memory(
                agent_id=self.agent_id,
                text=doc.content,
                metadata={
                    "type": "feishu_doc",
                    "doc_id": doc_id,
                    "title": doc.title,
                    "tenant_id": self.tenant_id
                }
            )
    
    async def import_database_schema(self, db_config: dict):
        """å¯¼å…¥æ•°æ®åº“è¡¨ç»“æ„"""
        schema_docs = await self._extract_schema_docs(db_config)
        
        for table_doc in schema_docs:
            await self.letta_client.insert_archival_memory(
                agent_id=self.agent_id,
                text=table_doc,
                metadata={
                    "type": "database_schema",
                    "tenant_id": self.tenant_id
                }
            )
    
    async def import_labeling_data(self, file_path: str):
        """å¯¼å…¥æ ‡æ³¨æ•°æ®ç¤ºä¾‹"""
        data = self._load_json(file_path)
        
        # æå–æ•°æ®ç»“æ„è¯´æ˜
        schema_desc = self._generate_schema_description(data)
        
        # æå–ç¤ºä¾‹æ•°æ®
        samples = self._extract_samples(data, n=5)
        
        await self.letta_client.insert_archival_memory(
            agent_id=self.agent_id,
            text=f"æ ‡æ³¨æ•°æ®ç»“æ„:\n{schema_desc}\n\nç¤ºä¾‹æ•°æ®:\n{samples}",
            metadata={
                "type": "labeling_data",
                "file_path": file_path,
                "tenant_id": self.tenant_id
            }
        )
    
    async def import_meeting_transcript(self, video_path: str):
        """å¯¼å…¥ä¼šè®®è§†é¢‘ï¼ˆè½¬å½•ï¼‰"""
        # ä½¿ç”¨ Whisper è½¬å½•
        transcript = await self._transcribe_video(video_path)
        
        # åˆ†æ®µå­˜å‚¨
        segments = self._segment_transcript(transcript)
        
        for segment in segments:
            await self.letta_client.insert_archival_memory(
                agent_id=self.agent_id,
                text=segment.text,
                metadata={
                    "type": "meeting_transcript",
                    "video_path": video_path,
                    "start_time": segment.start,
                    "end_time": segment.end,
                    "tenant_id": self.tenant_id
                }
            )
```

### 6.3 ä¸Šä¸‹æ–‡æ£€ç´¢æµç¨‹

```python
# context/retriever.py

class ContextRetriever:
    """ä¸Šä¸‹æ–‡æ£€ç´¢å™¨"""
    
    async def retrieve(self, query: str, tenant_id: str) -> dict:
        """æ£€ç´¢ç›¸å…³ä¸Šä¸‹æ–‡"""
        
        # 1. æ£€ç´¢æ¡£æ¡ˆè®°å¿†ï¼ˆå‘é‡ç›¸ä¼¼åº¦æœç´¢ï¼‰
        archival_results = await self.letta_client.archival_memory_search(
            agent_id=self.agent_id,
            query=query,
            k=10
        )
        
        # 2. æ£€ç´¢å†å²å¯¹è¯
        conversation_results = await self.letta_client.conversation_search(
            agent_id=self.agent_id,
            query=query,
            k=5
        )
        
        # 3. è·å–æ ¸å¿ƒè®°å¿†
        core_memory = await self.letta_client.get_core_memory(
            agent_id=self.agent_id
        )
        
        # 4. æ„å»ºä¸Šä¸‹æ–‡
        return {
            "core_memory": core_memory,
            "relevant_knowledge": self._format_archival(archival_results),
            "relevant_history": self._format_conversation(conversation_results),
            "total_tokens": self._count_tokens(...)
        }
```

---

## 7. æ¨¡å‹ç®¡ç†è®¾è®¡

### 7.1 LiteLLM é…ç½®

```yaml
# config/litellm_config.yaml

model_list:
  # ä¸»åŠ›æ¨¡å‹ - å¤æ‚æ¨ç†
  - model_name: main-reasoning
    litellm_params:
      model: anthropic/claude-3-5-sonnet-20241022
      api_key: os.environ/ANTHROPIC_API_KEY
      max_tokens: 8192
    model_info:
      description: "ä¸»åŠ›æ¨ç†æ¨¡å‹ï¼Œç”¨äºå¤æ‚ä»»åŠ¡è§„åˆ’å’Œåˆ†æ"
      cost_per_1k_input: 0.003
      cost_per_1k_output: 0.015
      
  # å¤‡ç”¨æ¨¡å‹ - å¤æ‚æ¨ç†
  - model_name: backup-reasoning
    litellm_params:
      model: openai/gpt-4o
      api_key: os.environ/OPENAI_API_KEY
      max_tokens: 8192
    model_info:
      description: "å¤‡ç”¨æ¨ç†æ¨¡å‹"
      
  # å¿«é€Ÿæ¨¡å‹ - ç®€å•ä»»åŠ¡
  - model_name: fast-task
    litellm_params:
      model: deepseek/deepseek-chat
      api_key: os.environ/DEEPSEEK_API_KEY
      max_tokens: 4096
    model_info:
      description: "å¿«é€Ÿä»»åŠ¡æ¨¡å‹ï¼Œç”¨äºç®€å•æŸ¥è¯¢å’Œæ ¼å¼åŒ–"
      cost_per_1k_input: 0.0001
      cost_per_1k_output: 0.0002
      
  # ä»£ç æ¨¡å‹ - ä»£ç ç”Ÿæˆ
  - model_name: code-gen
    litellm_params:
      model: deepseek/deepseek-coder
      api_key: os.environ/DEEPSEEK_API_KEY
      max_tokens: 8192
    model_info:
      description: "ä»£ç ç”Ÿæˆä¸“ç”¨æ¨¡å‹"

  # Embedding æ¨¡å‹
  - model_name: embedding
    litellm_params:
      model: openai/text-embedding-3-small
      api_key: os.environ/OPENAI_API_KEY

# è·¯ç”±é…ç½®
router_settings:
  routing_strategy: "cost-based-routing"  # æˆæœ¬ä¼˜å…ˆ
  num_retries: 3
  timeout: 60
  
  # Fallback é“¾
  fallbacks:
    main-reasoning: [backup-reasoning, fast-task]
    code-gen: [main-reasoning, fast-task]

# é™æµé…ç½®
litellm_settings:
  max_budget: 100  # æ¯æœˆé¢„ç®—ä¸Šé™ (USD)
  budget_duration: "monthly"
  
  # æŒ‰ç§Ÿæˆ·é™æµ
  tenant_rpm_limit: 60
  tenant_tpm_limit: 100000
```

### 7.2 æ¨¡å‹è·¯ç”±å™¨

```python
# model/router.py
import litellm
from litellm import Router

class ModelRouter:
    """æ™ºèƒ½æ¨¡å‹è·¯ç”±å™¨"""
    
    def __init__(self, config_path: str):
        self.config = self._load_config(config_path)
        self.router = Router(
            model_list=self.config["model_list"],
            routing_strategy=self.config["router_settings"]["routing_strategy"],
            num_retries=self.config["router_settings"]["num_retries"]
        )
        
        # ä»»åŠ¡ç±»å‹åˆ°æ¨¡å‹çš„æ˜ å°„
        self.task_model_map = {
            "planning": "main-reasoning",
            "analysis": "main-reasoning", 
            "code_generation": "code-gen",
            "simple_query": "fast-task",
            "formatting": "fast-task",
            "embedding": "embedding"
        }
    
    async def route_completion(
        self, 
        messages: list, 
        task_type: str = "planning",
        tenant_id: str = None
    ):
        """æ ¹æ®ä»»åŠ¡ç±»å‹è·¯ç”±åˆ°åˆé€‚çš„æ¨¡å‹"""
        
        model_name = self.task_model_map.get(task_type, "main-reasoning")
        
        # æ£€æŸ¥ç§Ÿæˆ·é…é¢
        if tenant_id:
            await self._check_quota(tenant_id)
        
        try:
            response = await self.router.acompletion(
                model=model_name,
                messages=messages
            )
            
            # è®°å½•ç”¨é‡
            if tenant_id:
                await self._record_usage(tenant_id, response)
            
            return response
            
        except Exception as e:
            # Fallback å·²åœ¨ Router ä¸­å¤„ç†
            raise
    
    async def _check_quota(self, tenant_id: str):
        """æ£€æŸ¥ç§Ÿæˆ·é…é¢"""
        usage = await self._get_tenant_usage(tenant_id)
        limit = await self._get_tenant_limit(tenant_id)
        
        if usage >= limit:
            raise QuotaExceededException(f"ç§Ÿæˆ· {tenant_id} å·²è¶…å‡ºé…é¢")
    
    async def _record_usage(self, tenant_id: str, response):
        """è®°å½•ä½¿ç”¨é‡"""
        await self.db.execute("""
            INSERT INTO tbl_model_usage 
            (tenant_id, model, input_tokens, output_tokens, cost, create_time)
            VALUES ($1, $2, $3, $4, $5, NOW())
        """, tenant_id, response.model, 
            response.usage.prompt_tokens,
            response.usage.completion_tokens,
            self._calculate_cost(response))
```

---

## 8. Tool/Skill/MCP ç®¡ç†è®¾è®¡

### 8.1 å·¥å…·æ³¨å†Œè¡¨

```python
# tools/registry.py

class ToolRegistry:
    """å·¥å…·æ³¨å†Œè¡¨"""
    
    def __init__(self, db):
        self.db = db
        self.tools = {}  # å†…å­˜ç¼“å­˜
        self.mcp_clients = {}  # MCP å®¢æˆ·ç«¯
    
    async def register_tool(self, tool_config: dict):
        """æ³¨å†Œæ–°å·¥å…·"""
        tool = Tool(
            id=tool_config["id"],
            name=tool_config["name"],
            description=tool_config["description"],
            type=tool_config["type"],  # builtin / mcp / custom
            parameters=tool_config["parameters"],
            handler=tool_config.get("handler"),
            mcp_server=tool_config.get("mcp_server")
        )
        
        # å­˜å…¥æ•°æ®åº“
        await self.db.execute("""
            INSERT INTO tbl_tools (id, name, description, type, config, tenant_id)
            VALUES ($1, $2, $3, $4, $5, $6)
            ON CONFLICT (id) DO UPDATE SET ...
        """, tool.id, tool.name, tool.description, 
            tool.type, json.dumps(tool_config), tool_config.get("tenant_id"))
        
        # æ›´æ–°ç¼“å­˜
        self.tools[tool.id] = tool
        
        return tool
    
    async def get_tenant_tools(self, tenant_id: str) -> list:
        """è·å–ç§Ÿæˆ·å¯ç”¨çš„å·¥å…·åˆ—è¡¨"""
        # è·å–ç³»ç»Ÿå·¥å…· + ç§Ÿæˆ·è‡ªå®šä¹‰å·¥å…·
        tools = await self.db.fetch("""
            SELECT * FROM tbl_tools 
            WHERE tenant_id IS NULL OR tenant_id = $1
            AND enabled = true
        """, tenant_id)
        
        return [self._to_tool_schema(t) for t in tools]
    
    def _to_tool_schema(self, tool_record) -> dict:
        """è½¬æ¢ä¸º OpenAI function calling æ ¼å¼"""
        return {
            "type": "function",
            "function": {
                "name": tool_record["name"],
                "description": tool_record["description"],
                "parameters": tool_record["config"]["parameters"]
            }
        }
```

### 8.2 å†…ç½®å·¥å…·åˆ—è¡¨

```python
# tools/builtin/__init__.py

BUILTIN_TOOLS = [
    # æ•°æ®åº“å·¥å…·
    {
        "id": "sql_query",
        "name": "sql_query",
        "description": "æ‰§è¡Œ SQL æŸ¥è¯¢ï¼Œæ”¯æŒ SELECT è¯­å¥ã€‚ç”¨äºä»æ•°æ®åº“è·å–æ•°æ®ã€‚",
        "type": "builtin",
        "parameters": {
            "type": "object",
            "properties": {
                "query": {
                    "type": "string",
                    "description": "SQL æŸ¥è¯¢è¯­å¥ï¼ˆä»…æ”¯æŒ SELECTï¼‰"
                },
                "database": {
                    "type": "string",
                    "description": "æ•°æ®åº“åç§°",
                    "default": "default"
                }
            },
            "required": ["query"]
        }
    },
    
    # æ•°æ®å¯¼å‡ºå·¥å…·
    {
        "id": "export_data",
        "name": "export_data",
        "description": "å°†æ•°æ®å¯¼å‡ºä¸ºæ–‡ä»¶ï¼ˆCSV/Excel/JSONï¼‰",
        "type": "builtin",
        "parameters": {
            "type": "object",
            "properties": {
                "data": {
                    "type": "array",
                    "description": "è¦å¯¼å‡ºçš„æ•°æ®"
                },
                "format": {
                    "type": "string",
                    "enum": ["csv", "excel", "json"],
                    "description": "å¯¼å‡ºæ ¼å¼"
                },
                "filename": {
                    "type": "string",
                    "description": "æ–‡ä»¶å"
                }
            },
            "required": ["data", "format"]
        }
    },
    
    # Python ä»£ç æ‰§è¡Œ
    {
        "id": "python_execute",
        "name": "python_execute",
        "description": "åœ¨å®‰å…¨æ²™ç®±ä¸­æ‰§è¡Œ Python ä»£ç ï¼Œæ”¯æŒæ•°æ®åˆ†æå’Œå›¾è¡¨ç”Ÿæˆ",
        "type": "builtin",
        "parameters": {
            "type": "object",
            "properties": {
                "code": {
                    "type": "string",
                    "description": "Python ä»£ç "
                }
            },
            "required": ["code"]
        }
    },
    
    # å›¾è¡¨ç”Ÿæˆ
    {
        "id": "generate_chart",
        "name": "generate_chart",
        "description": "æ ¹æ®æ•°æ®ç”Ÿæˆå›¾è¡¨ï¼ˆæŸ±çŠ¶å›¾/æŠ˜çº¿å›¾/é¥¼å›¾ç­‰ï¼‰",
        "type": "builtin",
        "parameters": {
            "type": "object",
            "properties": {
                "data": {
                    "type": "array",
                    "description": "å›¾è¡¨æ•°æ®"
                },
                "chart_type": {
                    "type": "string",
                    "enum": ["bar", "line", "pie", "scatter", "heatmap"],
                    "description": "å›¾è¡¨ç±»å‹"
                },
                "title": {
                    "type": "string",
                    "description": "å›¾è¡¨æ ‡é¢˜"
                },
                "x_label": {"type": "string"},
                "y_label": {"type": "string"}
            },
            "required": ["data", "chart_type"]
        }
    },
    
    # æ–‡ä»¶è¯»å–
    {
        "id": "read_file",
        "name": "read_file", 
        "description": "è¯»å–æ–‡ä»¶å†…å®¹ï¼ˆæ”¯æŒ JSON/CSV/TXT/Excelï¼‰",
        "type": "builtin",
        "parameters": {
            "type": "object",
            "properties": {
                "file_path": {
                    "type": "string",
                    "description": "æ–‡ä»¶è·¯å¾„"
                }
            },
            "required": ["file_path"]
        }
    },
    
    # æŠ¥å‘Šç”Ÿæˆ
    {
        "id": "generate_report",
        "name": "generate_report",
        "description": "ç”Ÿæˆæ•°æ®åˆ†ææŠ¥å‘Šï¼ˆMarkdown/HTML/PDFï¼‰",
        "type": "builtin",
        "parameters": {
            "type": "object",
            "properties": {
                "title": {"type": "string"},
                "sections": {
                    "type": "array",
                    "items": {
                        "type": "object",
                        "properties": {
                            "heading": {"type": "string"},
                            "content": {"type": "string"},
                            "charts": {"type": "array"}
                        }
                    }
                },
                "format": {
                    "type": "string",
                    "enum": ["markdown", "html", "pdf"]
                }
            },
            "required": ["title", "sections"]
        }
    },
    
    # JSON å¤„ç†
    {
        "id": "process_json",
        "name": "process_json",
        "description": "å¤„ç† JSON æ•°æ®ï¼ˆè¿‡æ»¤/è½¬æ¢/èšåˆï¼‰",
        "type": "builtin",
        "parameters": {
            "type": "object",
            "properties": {
                "data": {"type": "array"},
                "operations": {
                    "type": "array",
                    "items": {
                        "type": "object",
                        "properties": {
                            "type": {
                                "type": "string",
                                "enum": ["filter", "map", "group_by", "aggregate"]
                            },
                            "config": {"type": "object"}
                        }
                    }
                }
            },
            "required": ["data", "operations"]
        }
    }
]
```

### 8.3 MCP å·¥å…·é›†æˆ

```python
# tools/mcp_manager.py
from mcp import ClientSession, StdioServerParameters

class MCPManager:
    """MCP å·¥å…·ç®¡ç†å™¨"""
    
    def __init__(self):
        self.servers = {}
        self.sessions = {}
    
    async def register_mcp_server(self, server_config: dict):
        """æ³¨å†Œ MCP æœåŠ¡å™¨"""
        server_id = server_config["id"]
        
        if server_config["type"] == "stdio":
            params = StdioServerParameters(
                command=server_config["command"],
                args=server_config.get("args", []),
                env=server_config.get("env", {})
            )
            
            session = await ClientSession(params).__aenter__()
            self.sessions[server_id] = session
            
            # è·å–æœåŠ¡å™¨æä¾›çš„å·¥å…·
            tools = await session.list_tools()
            self.servers[server_id] = {
                "config": server_config,
                "tools": tools
            }
            
            return tools
    
    async def call_mcp_tool(self, server_id: str, tool_name: str, arguments: dict):
        """è°ƒç”¨ MCP å·¥å…·"""
        session = self.sessions.get(server_id)
        if not session:
            raise ValueError(f"MCP server {server_id} not found")
        
        result = await session.call_tool(tool_name, arguments)
        return result

# é¢„ç½® MCP æœåŠ¡å™¨é…ç½®
MCP_SERVERS = [
    {
        "id": "filesystem",
        "name": "æ–‡ä»¶ç³»ç»Ÿ",
        "type": "stdio",
        "command": "npx",
        "args": ["-y", "@modelcontextprotocol/server-filesystem", "/workspace"]
    },
    {
        "id": "postgres",
        "name": "PostgreSQL",
        "type": "stdio", 
        "command": "npx",
        "args": ["-y", "@modelcontextprotocol/server-postgres"],
        "env": {
            "POSTGRES_URL": "postgresql://..."
        }
    },
    {
        "id": "github",
        "name": "GitHub",
        "type": "stdio",
        "command": "npx",
        "args": ["-y", "@modelcontextprotocol/server-github"],
        "env": {
            "GITHUB_TOKEN": "..."
        }
    }
]
```

---

## 9. åœºæ™¯å®ç°è¯¦è§£

### 9.1 åœºæ™¯ä¸€ï¼šæ•°æ®å¯¼å‡ºä¸åˆ†ææŠ¥å‘Š

**ç”¨æˆ·è¾“å…¥**: "å¸®æˆ‘å¯¼å‡ºä¸Šå‘¨æ‰€æœ‰æ ‡æ³¨å‘˜çš„æ ‡æ³¨æ•°æ®ï¼Œç”Ÿæˆæ•°æ®åˆ†ææŠ¥å‘Š"

#### å®Œæ•´è°ƒç”¨æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 1: æ„å›¾ç†è§£ & ä¸Šä¸‹æ–‡æ£€ç´¢                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  ç”¨æˆ·è¾“å…¥: "å¸®æˆ‘å¯¼å‡ºä¸Šå‘¨æ‰€æœ‰æ ‡æ³¨å‘˜çš„æ ‡æ³¨æ•°æ®ï¼Œç”Ÿæˆæ•°æ®åˆ†ææŠ¥å‘Š"     â”‚
â”‚                                                                  â”‚
â”‚  â†’ Letta æ£€ç´¢ç›¸å…³ä¸Šä¸‹æ–‡:                                         â”‚
â”‚    - æ ‡æ³¨æ•°æ®è¡¨ç»“æ„ (tbl_annotations, tbl_labelers)              â”‚
â”‚    - ç”¨æˆ·åå¥½ (å–œæ¬¢ Excel æ ¼å¼ï¼Œè¯¦ç»†æŠ¥å‘Š)                         â”‚
â”‚    - å†å²ç±»ä¼¼ä»»åŠ¡ (ä¸Šæ¬¡ç”ŸæˆæŠ¥å‘Šçš„æ ¼å¼)                            â”‚
â”‚                                                                  â”‚
â”‚  â†’ æ„å»ºå¢å¼º Prompt                                               â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 2: ä»»åŠ¡è§„åˆ’                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  LLM ç”Ÿæˆæ‰§è¡Œè®¡åˆ’:                                               â”‚
â”‚                                                                  â”‚
â”‚  Plan:                                                           â”‚
â”‚  â”œâ”€â”€ 1. æŸ¥è¯¢ä¸Šå‘¨æ—¶é—´èŒƒå›´                                         â”‚
â”‚  â”œâ”€â”€ 2. æŸ¥è¯¢æ ‡æ³¨å‘˜åˆ—è¡¨                                           â”‚
â”‚  â”œâ”€â”€ 3. æŸ¥è¯¢æ ‡æ³¨æ•°æ® (sql_query)                                 â”‚
â”‚  â”œâ”€â”€ 4. æ•°æ®èšåˆåˆ†æ (python_execute)                            â”‚
â”‚  â”‚      - æŒ‰æ ‡æ³¨å‘˜ç»Ÿè®¡                                           â”‚
â”‚  â”‚      - æŒ‰æ—¥æœŸç»Ÿè®¡                                             â”‚
â”‚  â”‚      - è´¨é‡åˆ†æ                                               â”‚
â”‚  â”œâ”€â”€ 5. ç”Ÿæˆå›¾è¡¨ (generate_chart)                                â”‚
â”‚  â”‚      - æ ‡æ³¨é‡è¶‹åŠ¿å›¾                                           â”‚
â”‚  â”‚      - æ ‡æ³¨å‘˜å¯¹æ¯”å›¾                                           â”‚
â”‚  â”œâ”€â”€ 6. å¯¼å‡ºåŸå§‹æ•°æ® (export_data)                               â”‚
â”‚  â””â”€â”€ 7. ç”ŸæˆæŠ¥å‘Š (generate_report)                               â”‚
â”‚                                                                  â”‚
â”‚  WebSocket æ¨é€: { type: "plan", data: plan }                    â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 3: æ‰§è¡Œ - æŸ¥è¯¢æ•°æ®                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  Tool Call: sql_query                                            â”‚
â”‚  Arguments: {                                                    â”‚
â”‚    "query": """                                                  â”‚
â”‚      SELECT                                                      â”‚
â”‚        l.name as labeler_name,                                   â”‚
â”‚        DATE(a.create_time) as date,                              â”‚
â”‚        COUNT(*) as annotation_count,                             â”‚
â”‚        AVG(a.quality_score) as avg_quality                       â”‚
â”‚      FROM tbl_annotations a                                      â”‚
â”‚      JOIN tbl_labelers l ON a.labeler_id = l.id                  â”‚
â”‚      WHERE a.create_time >= NOW() - INTERVAL '7 days'            â”‚
â”‚      GROUP BY l.name, DATE(a.create_time)                        â”‚
â”‚      ORDER BY date, labeler_name                                 â”‚
â”‚    """                                                           â”‚
â”‚  }                                                               â”‚
â”‚                                                                  â”‚
â”‚  Result: [                                                       â”‚
â”‚    {"labeler_name": "å¼ ä¸‰", "date": "2026-02-03", ...},          â”‚
â”‚    {"labeler_name": "æå››", "date": "2026-02-03", ...},          â”‚
â”‚    ...                                                           â”‚
â”‚  ]                                                               â”‚
â”‚                                                                  â”‚
â”‚  WebSocket æ¨é€: { type: "tool_result", data: result }           â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 4: æ‰§è¡Œ - æ•°æ®åˆ†æ                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  Tool Call: python_execute                                       â”‚
â”‚  Arguments: {                                                    â”‚
â”‚    "code": """                                                   â”‚
â”‚      import pandas as pd                                         â”‚
â”‚      import numpy as np                                          â”‚
â”‚                                                                  â”‚
â”‚      df = pd.DataFrame(data)                                     â”‚
â”‚                                                                  â”‚
â”‚      # æŒ‰æ ‡æ³¨å‘˜æ±‡æ€»                                               â”‚
â”‚      by_labeler = df.groupby('labeler_name').agg({               â”‚
â”‚          'annotation_count': 'sum',                              â”‚
â”‚          'avg_quality': 'mean'                                   â”‚
â”‚      }).round(2)                                                 â”‚
â”‚                                                                  â”‚
â”‚      # æŒ‰æ—¥æœŸæ±‡æ€»                                                 â”‚
â”‚      by_date = df.groupby('date').agg({                          â”‚
â”‚          'annotation_count': 'sum'                               â”‚
â”‚      })                                                          â”‚
â”‚                                                                  â”‚
â”‚      # è®¡ç®—ç»Ÿè®¡æŒ‡æ ‡                                               â”‚
â”‚      stats = {                                                   â”‚
â”‚          'total_annotations': df['annotation_count'].sum(),      â”‚
â”‚          'avg_daily': df.groupby('date')['annotation_count']     â”‚
â”‚                        .sum().mean(),                            â”‚
â”‚          'top_labeler': by_labeler['annotation_count'].idxmax(), â”‚
â”‚          'avg_quality': df['avg_quality'].mean()                 â”‚
â”‚      }                                                           â”‚
â”‚                                                                  â”‚
â”‚      result = {                                                  â”‚
â”‚          'by_labeler': by_labeler.to_dict(),                     â”‚
â”‚          'by_date': by_date.to_dict(),                           â”‚
â”‚          'stats': stats                                          â”‚
â”‚      }                                                           â”‚
â”‚    """                                                           â”‚
â”‚  }                                                               â”‚
â”‚                                                                  â”‚
â”‚  Result: {                                                       â”‚
â”‚    "by_labeler": {...},                                          â”‚
â”‚    "by_date": {...},                                             â”‚
â”‚    "stats": {                                                    â”‚
â”‚      "total_annotations": 1523,                                  â”‚
â”‚      "avg_daily": 217.6,                                         â”‚
â”‚      "top_labeler": "å¼ ä¸‰",                                      â”‚
â”‚      "avg_quality": 0.92                                         â”‚
â”‚    }                                                             â”‚
â”‚  }                                                               â”‚
â”‚                                                                  â”‚
â”‚  WebSocket æ¨é€: { type: "tool_result", data: analysis }         â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 5: æ‰§è¡Œ - ç”Ÿæˆå›¾è¡¨                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  Tool Call: generate_chart                                       â”‚
â”‚  Arguments: {                                                    â”‚
â”‚    "data": by_date_data,                                         â”‚
â”‚    "chart_type": "line",                                         â”‚
â”‚    "title": "ä¸Šå‘¨æ ‡æ³¨é‡è¶‹åŠ¿",                                     â”‚
â”‚    "x_label": "æ—¥æœŸ",                                            â”‚
â”‚    "y_label": "æ ‡æ³¨æ•°é‡"                                         â”‚
â”‚  }                                                               â”‚
â”‚                                                                  â”‚
â”‚  Result: {                                                       â”‚
â”‚    "chart_url": "/files/charts/trend_20260210.png",              â”‚
â”‚    "chart_base64": "..."                                         â”‚
â”‚  }                                                               â”‚
â”‚                                                                  â”‚
â”‚  Tool Call: generate_chart (ç¬¬äºŒä¸ªå›¾è¡¨)                          â”‚
â”‚  Arguments: {                                                    â”‚
â”‚    "data": by_labeler_data,                                      â”‚
â”‚    "chart_type": "bar",                                          â”‚
â”‚    "title": "æ ‡æ³¨å‘˜å·¥ä½œé‡å¯¹æ¯”"                                    â”‚
â”‚  }                                                               â”‚
â”‚                                                                  â”‚
â”‚  WebSocket æ¨é€: { type: "tool_result", data: charts }           â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 6: æ‰§è¡Œ - å¯¼å‡ºæ•°æ® & ç”ŸæˆæŠ¥å‘Š                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  Tool Call: export_data                                          â”‚
â”‚  Arguments: {                                                    â”‚
â”‚    "data": raw_data,                                             â”‚
â”‚    "format": "excel",                                            â”‚
â”‚    "filename": "æ ‡æ³¨æ•°æ®_20260203-20260209.xlsx"                  â”‚
â”‚  }                                                               â”‚
â”‚                                                                  â”‚
â”‚  Result: {                                                       â”‚
â”‚    "file_url": "/files/exports/æ ‡æ³¨æ•°æ®_20260203-20260209.xlsx"   â”‚
â”‚  }                                                               â”‚
â”‚                                                                  â”‚
â”‚  Tool Call: generate_report                                      â”‚
â”‚  Arguments: {                                                    â”‚
â”‚    "title": "æ ‡æ³¨æ•°æ®å‘¨æŠ¥ (2026.02.03 - 2026.02.09)",            â”‚
â”‚    "sections": [                                                 â”‚
â”‚      {                                                           â”‚
â”‚        "heading": "æ¦‚è¿°",                                        â”‚
â”‚        "content": "æœ¬å‘¨å…±å®Œæˆæ ‡æ³¨ 1523 æ¡..."                    â”‚
â”‚      },                                                          â”‚
â”‚      {                                                           â”‚
â”‚        "heading": "æ ‡æ³¨é‡åˆ†æ",                                  â”‚
â”‚        "content": "...",                                         â”‚
â”‚        "charts": [trend_chart, comparison_chart]                 â”‚
â”‚      },                                                          â”‚
â”‚      {                                                           â”‚
â”‚        "heading": "è´¨é‡åˆ†æ",                                    â”‚
â”‚        "content": "å¹³å‡è´¨é‡åˆ†æ•° 0.92..."                         â”‚
â”‚      },                                                          â”‚
â”‚      {                                                           â”‚
â”‚        "heading": "å»ºè®®",                                        â”‚
â”‚        "content": "å»ºè®®å…³æ³¨..."                                  â”‚
â”‚      }                                                           â”‚
â”‚    ],                                                            â”‚
â”‚    "format": "html"                                              â”‚
â”‚  }                                                               â”‚
â”‚                                                                  â”‚
â”‚  Result: {                                                       â”‚
â”‚    "report_url": "/files/reports/æ ‡æ³¨å‘¨æŠ¥_20260210.html"         â”‚
â”‚  }                                                               â”‚
â”‚                                                                  â”‚
â”‚  WebSocket æ¨é€: { type: "tool_result", data: report }           â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 7: æœ€ç»ˆè¾“å‡º                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  WebSocket æ¨é€: {                                               â”‚
â”‚    type: "final",                                                â”‚
â”‚    data: {                                                       â”‚
â”‚      "summary": "å·²å®Œæˆä¸Šå‘¨æ ‡æ³¨æ•°æ®å¯¼å‡ºå’Œåˆ†ææŠ¥å‘Šç”Ÿæˆ",           â”‚
â”‚      "outputs": [                                                â”‚
â”‚        {                                                         â”‚
â”‚          "type": "file",                                         â”‚
â”‚          "name": "æ ‡æ³¨æ•°æ®_20260203-20260209.xlsx",              â”‚
â”‚          "url": "/files/exports/...",                            â”‚
â”‚          "description": "åŸå§‹æ ‡æ³¨æ•°æ®"                           â”‚
â”‚        },                                                        â”‚
â”‚        {                                                         â”‚
â”‚          "type": "report",                                       â”‚
â”‚          "name": "æ ‡æ³¨å‘¨æŠ¥_20260210.html",                       â”‚
â”‚          "url": "/files/reports/...",                            â”‚
â”‚          "description": "æ•°æ®åˆ†ææŠ¥å‘Š"                           â”‚
â”‚        }                                                         â”‚
â”‚      ],                                                          â”‚
â”‚      "execution_history": [                                      â”‚
â”‚        { "step": "æŸ¥è¯¢æ•°æ®", "duration": "1.2s", "status": "âœ“" },â”‚
â”‚        { "step": "æ•°æ®åˆ†æ", "duration": "0.8s", "status": "âœ“" },â”‚
â”‚        { "step": "ç”Ÿæˆå›¾è¡¨", "duration": "2.1s", "status": "âœ“" },â”‚
â”‚        { "step": "å¯¼å‡ºæ•°æ®", "duration": "0.5s", "status": "âœ“" },â”‚
â”‚        { "step": "ç”ŸæˆæŠ¥å‘Š", "duration": "1.5s", "status": "âœ“" } â”‚
â”‚      ],                                                          â”‚
â”‚      "total_time": "6.1s"                                        â”‚
â”‚    }                                                             â”‚
â”‚  }                                                               â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ä»£ç å®ç°

```python
# scenarios/data_export_report.py

class DataExportReportScenario:
    """åœºæ™¯ä¸€ï¼šæ•°æ®å¯¼å‡ºä¸åˆ†ææŠ¥å‘Š"""
    
    async def execute(self, agent: EnterpriseAgent, user_input: str, ws: WebSocket):
        """æ‰§è¡Œæ•°æ®å¯¼å‡ºæŠ¥å‘Šåœºæ™¯"""
        
        # 1. æ£€ç´¢ä¸Šä¸‹æ–‡
        context = await agent.retrieve_context(user_input)
        
        # 2. æ„å»º Prompt
        prompt = f"""
ä½ æ˜¯ä¸€ä¸ªæ•°æ®åˆ†æåŠ©æ‰‹ã€‚ç”¨æˆ·è¯·æ±‚ï¼š{user_input}

ç›¸å…³ä¸Šä¸‹æ–‡ï¼š
- æ•°æ®åº“è¡¨ç»“æ„ï¼š{context['relevant_knowledge']}
- ç”¨æˆ·åå¥½ï¼š{context['core_memory']['human']}

è¯·ç”Ÿæˆæ‰§è¡Œè®¡åˆ’ï¼Œéœ€è¦ï¼š
1. ç¡®å®šæ—¶é—´èŒƒå›´
2. æŸ¥è¯¢ç›¸å…³æ•°æ®
3. è¿›è¡Œæ•°æ®åˆ†æ
4. ç”Ÿæˆå¯è§†åŒ–å›¾è¡¨
5. å¯¼å‡ºåŸå§‹æ•°æ®
6. ç”Ÿæˆåˆ†ææŠ¥å‘Š

è¾“å‡º JSON æ ¼å¼çš„æ‰§è¡Œè®¡åˆ’ã€‚
"""
        
        # 3. ç”Ÿæˆè®¡åˆ’
        plan = await agent.model_router.route_completion(
            messages=[{"role": "user", "content": prompt}],
            task_type="planning"
        )
        
        await ws.send_json({"type": "plan", "data": plan})
        
        # 4. æ‰§è¡Œè®¡åˆ’
        results = []
        for step in plan.steps:
            result = await agent.execute_tool(step.tool, step.arguments)
            results.append({"step": step, "result": result})
            await ws.send_json({"type": "tool_result", "data": result})
        
        # 5. ç”Ÿæˆæœ€ç»ˆè¾“å‡º
        final = await self._generate_final_output(results)
        await ws.send_json({"type": "final", "data": final})
        
        return final
```

---

### 9.2 åœºæ™¯äºŒï¼šä¸ªäººå‘¨æŠ¥ç”Ÿæˆ

**ç”¨æˆ·è¾“å…¥**: "å¸®æˆ‘ç”Ÿæˆæˆ‘è¿™å‘¨çš„å·¥ä½œå‘¨æŠ¥"

#### å®Œæ•´è°ƒç”¨æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 1: æ„å›¾ç†è§£ & ä¸Šä¸‹æ–‡æ£€ç´¢                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  ç”¨æˆ·è¾“å…¥: "å¸®æˆ‘ç”Ÿæˆæˆ‘è¿™å‘¨çš„å·¥ä½œå‘¨æŠ¥"                             â”‚
â”‚                                                                  â”‚
â”‚  â†’ Letta æ£€ç´¢:                                                   â”‚
â”‚    - ç”¨æˆ·èº«ä»½ (å¼ ä¸‰, æ•°æ®è¿è¥éƒ¨)                                  â”‚
â”‚    - ç”¨æˆ·æœ¬å‘¨æ´»åŠ¨æ•°æ®æº:                                         â”‚
â”‚      Â· Git æäº¤è®°å½•                                              â”‚
â”‚      Â· ä»»åŠ¡ç³»ç»Ÿå®Œæˆæƒ…å†µ                                          â”‚
â”‚      Â· ä¼šè®®å‚ä¸è®°å½•                                              â”‚
â”‚      Â· é£ä¹¦æ–‡æ¡£ç¼–è¾‘è®°å½•                                          â”‚
â”‚    - å†å²å‘¨æŠ¥æ ¼å¼                                                â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 2: ä»»åŠ¡è§„åˆ’                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  Plan:                                                           â”‚
â”‚  â”œâ”€â”€ 1. è·å–ç”¨æˆ·æœ¬å‘¨ Git æäº¤è®°å½• (mcp: github)                  â”‚
â”‚  â”œâ”€â”€ 2. è·å–ä»»åŠ¡ç³»ç»Ÿå®Œæˆæƒ…å†µ (sql_query)                         â”‚
â”‚  â”œâ”€â”€ 3. è·å–ä¼šè®®å‚ä¸è®°å½• (mcp: calendar)                         â”‚
â”‚  â”œâ”€â”€ 4. è·å–æ–‡æ¡£ç¼–è¾‘è®°å½• (mcp: feishu)                           â”‚
â”‚  â”œâ”€â”€ 5. æ±‡æ€»åˆ†æå·¥ä½œå†…å®¹ (python_execute)                        â”‚
â”‚  â””â”€â”€ 6. ç”Ÿæˆå‘¨æŠ¥ (generate_report)                               â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 3-6: æ‰§è¡Œå„æ­¥éª¤                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  Step 3: MCP Tool - github.get_commits                           â”‚
â”‚  Result: [                                                       â”‚
â”‚    {"message": "feat: æ·»åŠ æ•°æ®å¯¼å‡ºåŠŸèƒ½", "date": "02-05"},       â”‚
â”‚    {"message": "fix: ä¿®å¤åˆ†é¡µé—®é¢˜", "date": "02-06"},            â”‚
â”‚    ...                                                           â”‚
â”‚  ]                                                               â”‚
â”‚                                                                  â”‚
â”‚  Step 4: sql_query - æŸ¥è¯¢ä»»åŠ¡å®Œæˆæƒ…å†µ                            â”‚
â”‚  Result: [                                                       â”‚
â”‚    {"task": "æ•°æ®æ ‡æ³¨å¹³å°ä¼˜åŒ–", "status": "completed"},          â”‚
â”‚    {"task": "å‘¨æŠ¥ç³»ç»Ÿå¼€å‘", "status": "in_progress"},            â”‚
â”‚  ]                                                               â”‚
â”‚                                                                  â”‚
â”‚  Step 5: MCP Tool - calendar.get_events                          â”‚
â”‚  Result: [                                                       â”‚
â”‚    {"title": "äº§å“éœ€æ±‚è¯„å®¡", "date": "02-04"},                   â”‚
â”‚    {"title": "æŠ€æœ¯æ–¹æ¡ˆè®¨è®º", "date": "02-06"},                   â”‚
â”‚  ]                                                               â”‚
â”‚                                                                  â”‚
â”‚  Step 6: python_execute - æ±‡æ€»åˆ†æ                               â”‚
â”‚  Result: {                                                       â”‚
â”‚    "commits_count": 12,                                          â”‚
â”‚    "tasks_completed": 3,                                         â”‚
â”‚    "meetings_attended": 5,                                       â”‚
â”‚    "highlights": ["å®Œæˆæ•°æ®å¯¼å‡ºåŠŸèƒ½", "ä¿®å¤3ä¸ªBug"]              â”‚
â”‚  }                                                               â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 7: ç”Ÿæˆå‘¨æŠ¥                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  Tool Call: generate_report                                      â”‚
â”‚  Result:                                                         â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                    å·¥ä½œå‘¨æŠ¥                              â”‚    â”‚
â”‚  â”‚                2026.02.03 - 2026.02.09                   â”‚    â”‚
â”‚  â”‚                    å¼ ä¸‰ | æ•°æ®è¿è¥éƒ¨                      â”‚    â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚
â”‚  â”‚ ## æœ¬å‘¨å·¥ä½œæ€»ç»“                                          â”‚    â”‚
â”‚  â”‚                                                          â”‚    â”‚
â”‚  â”‚ ### 1. å¼€å‘å·¥ä½œ                                          â”‚    â”‚
â”‚  â”‚ - å®Œæˆæ•°æ®å¯¼å‡ºåŠŸèƒ½å¼€å‘ (12 commits)                      â”‚    â”‚
â”‚  â”‚ - ä¿®å¤åˆ†é¡µæ˜¾ç¤ºé—®é¢˜                                       â”‚    â”‚
â”‚  â”‚ - ä¼˜åŒ–æŸ¥è¯¢æ€§èƒ½                                           â”‚    â”‚
â”‚  â”‚                                                          â”‚    â”‚
â”‚  â”‚ ### 2. ä»»åŠ¡å®Œæˆæƒ…å†µ                                      â”‚    â”‚
â”‚  â”‚ - [x] æ•°æ®æ ‡æ³¨å¹³å°ä¼˜åŒ–                                   â”‚    â”‚
â”‚  â”‚ - [x] API æ–‡æ¡£æ›´æ–°                                       â”‚    â”‚
â”‚  â”‚ - [ ] å‘¨æŠ¥ç³»ç»Ÿå¼€å‘ (è¿›è¡Œä¸­)                              â”‚    â”‚
â”‚  â”‚                                                          â”‚    â”‚
â”‚  â”‚ ### 3. ä¼šè®®å‚ä¸                                          â”‚    â”‚
â”‚  â”‚ - äº§å“éœ€æ±‚è¯„å®¡ (02-04)                                   â”‚    â”‚
â”‚  â”‚ - æŠ€æœ¯æ–¹æ¡ˆè®¨è®º (02-06)                                   â”‚    â”‚
â”‚  â”‚                                                          â”‚    â”‚
â”‚  â”‚ ## ä¸‹å‘¨è®¡åˆ’                                              â”‚    â”‚
â”‚  â”‚ - å®Œæˆå‘¨æŠ¥ç³»ç»Ÿå¼€å‘                                       â”‚    â”‚
â”‚  â”‚ - å¼€å§‹ç”¨æˆ·åé¦ˆåˆ†æ                                       â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 9.3 åœºæ™¯ä¸‰ï¼šæ‰¹é‡è¯„æµ‹ç»“æœå¤„ç†

**ç”¨æˆ·è¾“å…¥**: "å¸®æˆ‘å¤„ç†è¿™æ‰¹è¯„æµ‹ç»“æœ JSONï¼Œç”Ÿæˆç»Ÿè®¡åˆ†æå›¾è¡¨ï¼Œåˆ—å‡ºé—®é¢˜æ•°æ®"

#### å®Œæ•´è°ƒç”¨æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 1: æ„å›¾ç†è§£ & ä¸Šä¸‹æ–‡æ£€ç´¢                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  ç”¨æˆ·è¾“å…¥: "å¸®æˆ‘å¤„ç†è¿™æ‰¹è¯„æµ‹ç»“æœ JSONï¼Œç”Ÿæˆç»Ÿè®¡åˆ†æå›¾è¡¨ï¼Œ         â”‚
â”‚            åˆ—å‡ºé—®é¢˜æ•°æ®"                                         â”‚
â”‚                                                                  â”‚
â”‚  é™„ä»¶: evaluation_results_20260209.json                          â”‚
â”‚                                                                  â”‚
â”‚  â†’ Letta æ£€ç´¢:                                                   â”‚
â”‚    - è¯„æµ‹æ•°æ®ç»“æ„è¯´æ˜                                            â”‚
â”‚    - é—®é¢˜æ•°æ®åˆ¤å®šæ ‡å‡† (å¦‚: score < 0.6 ä¸ºé—®é¢˜æ•°æ®)               â”‚
â”‚    - å†å²åˆ†ææŠ¥å‘Šæ ¼å¼                                            â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 2: ä»»åŠ¡è§„åˆ’                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  Plan:                                                           â”‚
â”‚  â”œâ”€â”€ 1. è¯»å– JSON æ–‡ä»¶ (read_file)                               â”‚
â”‚  â”œâ”€â”€ 2. è§£ææ•°æ®ç»“æ„ (python_execute)                            â”‚
â”‚  â”œâ”€â”€ 3. ç»Ÿè®¡åˆ†æ (python_execute)                                â”‚
â”‚  â”‚      - æ€»ä½“ç»Ÿè®¡ (æ€»æ•°ã€é€šè¿‡ç‡ã€å¹³å‡åˆ†)                        â”‚
â”‚  â”‚      - åˆ†ç±»ç»Ÿè®¡ (æŒ‰æ¨¡å‹ã€æŒ‰é¢˜å‹)                              â”‚
â”‚  â”‚      - é—®é¢˜æ•°æ®æå– (score < 0.6)                             â”‚
â”‚  â”œâ”€â”€ 4. ç”Ÿæˆå›¾è¡¨ (generate_chart)                                â”‚
â”‚  â”‚      - åˆ†æ•°åˆ†å¸ƒç›´æ–¹å›¾                                         â”‚
â”‚  â”‚      - æ¨¡å‹å¯¹æ¯”æŸ±çŠ¶å›¾                                         â”‚
â”‚  â”‚      - é¢˜å‹é€šè¿‡ç‡é¥¼å›¾                                         â”‚
â”‚  â”œâ”€â”€ 5. å¯¼å‡ºé—®é¢˜æ•°æ® (export_data)                               â”‚
â”‚  â””â”€â”€ 6. ç”Ÿæˆåˆ†ææŠ¥å‘Š (generate_report)                           â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 3: è¯»å–å¹¶è§£æ JSON                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  Tool Call: read_file                                            â”‚
â”‚  Result: {                                                       â”‚
â”‚    "total_records": 5000,                                        â”‚
â”‚    "sample": [                                                   â”‚
â”‚      {                                                           â”‚
â”‚        "id": "eval_001",                                         â”‚
â”‚        "model": "gpt-4o",                                        â”‚
â”‚        "question_type": "reasoning",                             â”‚
â”‚        "score": 0.85,                                            â”‚
â”‚        "response": "...",                                        â”‚
â”‚        "expected": "..."                                         â”‚
â”‚      },                                                          â”‚
â”‚      ...                                                         â”‚
â”‚    ]                                                             â”‚
â”‚  }                                                               â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 4: ç»Ÿè®¡åˆ†æ                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  Tool Call: python_execute                                       â”‚
â”‚  Code:                                                           â”‚
â”‚  ```python                                                       â”‚
â”‚  import pandas as pd                                             â”‚
â”‚  import numpy as np                                              â”‚
â”‚                                                                  â”‚
â”‚  df = pd.DataFrame(data)                                         â”‚
â”‚                                                                  â”‚
â”‚  # æ€»ä½“ç»Ÿè®¡                                                      â”‚
â”‚  stats = {                                                       â”‚
â”‚      'total': len(df),                                           â”‚
â”‚      'pass_rate': (df['score'] >= 0.6).mean(),                   â”‚
â”‚      'avg_score': df['score'].mean(),                            â”‚
â”‚      'std_score': df['score'].std()                              â”‚
â”‚  }                                                               â”‚
â”‚                                                                  â”‚
â”‚  # æŒ‰æ¨¡å‹ç»Ÿè®¡                                                    â”‚
â”‚  by_model = df.groupby('model').agg({                            â”‚
â”‚      'score': ['mean', 'std', 'count'],                          â”‚
â”‚      'id': lambda x: (df.loc[x.index, 'score'] >= 0.6).mean()    â”‚
â”‚  })                                                              â”‚
â”‚                                                                  â”‚
â”‚  # é—®é¢˜æ•°æ®                                                      â”‚
â”‚  problems = df[df['score'] < 0.6].to_dict('records')             â”‚
â”‚  ```                                                             â”‚
â”‚                                                                  â”‚
â”‚  Result: {                                                       â”‚
â”‚    "stats": {                                                    â”‚
â”‚      "total": 5000,                                              â”‚
â”‚      "pass_rate": 0.78,                                          â”‚
â”‚      "avg_score": 0.72,                                          â”‚
â”‚      "std_score": 0.18                                           â”‚
â”‚    },                                                            â”‚
â”‚    "by_model": {...},                                            â”‚
â”‚    "by_question_type": {...},                                    â”‚
â”‚    "problems_count": 1100,                                       â”‚
â”‚    "problems_sample": [...]                                      â”‚
â”‚  }                                                               â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 5: ç”Ÿæˆå›¾è¡¨                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  Chart 1: åˆ†æ•°åˆ†å¸ƒç›´æ–¹å›¾                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚
â”‚  â”‚    â–“â–“â–“                              â”‚                         â”‚
â”‚  â”‚    â–“â–“â–“â–“â–“â–“                           â”‚                         â”‚
â”‚  â”‚    â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“                       â”‚                         â”‚
â”‚  â”‚    â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“                  â”‚                         â”‚
â”‚  â”‚    â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“              â”‚                         â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€         â”‚                         â”‚
â”‚  â”‚ 0.0  0.2  0.4  0.6  0.8  1.0        â”‚                         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚
â”‚                                                                  â”‚
â”‚  Chart 2: æ¨¡å‹å¯¹æ¯”æŸ±çŠ¶å›¾                                         â”‚
â”‚  Chart 3: é¢˜å‹é€šè¿‡ç‡é¥¼å›¾                                         â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 6: å¯¼å‡ºé—®é¢˜æ•°æ®                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  Tool Call: export_data                                          â”‚
â”‚  Arguments: {                                                    â”‚
â”‚    "data": problems,                                             â”‚
â”‚    "format": "excel",                                            â”‚
â”‚    "filename": "é—®é¢˜æ•°æ®_20260209.xlsx"                          â”‚
â”‚  }                                                               â”‚
â”‚                                                                  â”‚
â”‚  Result: {                                                       â”‚
â”‚    "file_url": "/files/exports/é—®é¢˜æ•°æ®_20260209.xlsx",          â”‚
â”‚    "records_count": 1100                                         â”‚
â”‚  }                                                               â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 7: æœ€ç»ˆè¾“å‡º                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  {                                                               â”‚
â”‚    "summary": "è¯„æµ‹ç»“æœåˆ†æå®Œæˆ",                                â”‚
â”‚    "key_findings": [                                             â”‚
â”‚      "æ€»è¯„æµ‹æ•°: 5000 æ¡",                                        â”‚
â”‚      "æ•´ä½“é€šè¿‡ç‡: 78%",                                          â”‚
â”‚      "å¹³å‡åˆ†: 0.72",                                             â”‚
â”‚      "é—®é¢˜æ•°æ®: 1100 æ¡ (22%)"                                   â”‚
â”‚    ],                                                            â”‚
â”‚    "outputs": [                                                  â”‚
â”‚      {                                                           â”‚
â”‚        "type": "chart",                                          â”‚
â”‚        "name": "åˆ†æ•°åˆ†å¸ƒå›¾",                                     â”‚
â”‚        "url": "/files/charts/score_dist.png"                     â”‚
â”‚      },                                                          â”‚
â”‚      {                                                           â”‚
â”‚        "type": "chart",                                          â”‚
â”‚        "name": "æ¨¡å‹å¯¹æ¯”å›¾",                                     â”‚
â”‚        "url": "/files/charts/model_compare.png"                  â”‚
â”‚      },                                                          â”‚
â”‚      {                                                           â”‚
â”‚        "type": "file",                                           â”‚
â”‚        "name": "é—®é¢˜æ•°æ®",                                       â”‚
â”‚        "url": "/files/exports/é—®é¢˜æ•°æ®_20260209.xlsx"            â”‚
â”‚      },                                                          â”‚
â”‚      {                                                           â”‚
â”‚        "type": "report",                                         â”‚
â”‚        "name": "åˆ†ææŠ¥å‘Š",                                       â”‚
â”‚        "url": "/files/reports/è¯„æµ‹åˆ†æ_20260209.html"            â”‚
â”‚      }                                                           â”‚
â”‚    ],                                                            â”‚
â”‚    "problems_preview": [                                         â”‚
â”‚      {"id": "eval_123", "model": "gpt-4o", "score": 0.35, ...}, â”‚
â”‚      {"id": "eval_456", "model": "claude", "score": 0.42, ...}, â”‚
â”‚      ...                                                         â”‚
â”‚    ],                                                            â”‚
â”‚    "execution_history": [...]                                    â”‚
â”‚  }                                                               â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 10. API è®¾è®¡

### 10.1 æ ¸å¿ƒ API

```yaml
# API åˆ—è¡¨

# ä»»åŠ¡æ‰§è¡Œ
POST   /api/v1/agent/execute          # æ‰§è¡Œä»»åŠ¡ï¼ˆHTTPï¼‰
WS     /api/v1/agent/execute/stream   # æ‰§è¡Œä»»åŠ¡ï¼ˆWebSocket æµå¼ï¼‰

# ä¸Šä¸‹æ–‡ç®¡ç†
POST   /api/v1/context/import         # å¯¼å…¥çŸ¥è¯†
GET    /api/v1/context/search         # æœç´¢ä¸Šä¸‹æ–‡
DELETE /api/v1/context/{id}           # åˆ é™¤ä¸Šä¸‹æ–‡

# å·¥å…·ç®¡ç†
GET    /api/v1/tools                  # è·å–å·¥å…·åˆ—è¡¨
POST   /api/v1/tools                  # æ³¨å†Œå·¥å…·
PUT    /api/v1/tools/{id}             # æ›´æ–°å·¥å…·
DELETE /api/v1/tools/{id}             # åˆ é™¤å·¥å…·
POST   /api/v1/tools/{id}/test        # æµ‹è¯•å·¥å…·

# MCP æœåŠ¡ç®¡ç†
GET    /api/v1/mcp/servers            # è·å– MCP æœåŠ¡å™¨åˆ—è¡¨
POST   /api/v1/mcp/servers            # æ³¨å†Œ MCP æœåŠ¡å™¨
DELETE /api/v1/mcp/servers/{id}       # åˆ é™¤ MCP æœåŠ¡å™¨
GET    /api/v1/mcp/servers/{id}/tools # è·å–æœåŠ¡å™¨å·¥å…·

# æ¨¡å‹ç®¡ç†
GET    /api/v1/models                 # è·å–æ¨¡å‹åˆ—è¡¨
POST   /api/v1/models                 # æ·»åŠ æ¨¡å‹
PUT    /api/v1/models/{id}            # æ›´æ–°æ¨¡å‹é…ç½®
GET    /api/v1/models/usage           # è·å–ç”¨é‡ç»Ÿè®¡

# ä»»åŠ¡å†å²
GET    /api/v1/tasks                  # è·å–ä»»åŠ¡åˆ—è¡¨
GET    /api/v1/tasks/{id}             # è·å–ä»»åŠ¡è¯¦æƒ…
GET    /api/v1/tasks/{id}/history     # è·å–æ‰§è¡Œå†å²

# æ–‡ä»¶ç®¡ç†
GET    /api/v1/files                  # è·å–æ–‡ä»¶åˆ—è¡¨
GET    /api/v1/files/{id}/download    # ä¸‹è½½æ–‡ä»¶
DELETE /api/v1/files/{id}             # åˆ é™¤æ–‡ä»¶
```

### 10.2 WebSocket æ¶ˆæ¯æ ¼å¼

```typescript
// å®¢æˆ·ç«¯å‘é€
interface ClientMessage {
  type: "execute" | "cancel" | "feedback";
  data: {
    task?: string;          // ä»»åŠ¡æè¿°
    task_id?: string;       // ä»»åŠ¡ IDï¼ˆå–æ¶ˆæ—¶ä½¿ç”¨ï¼‰
    attachments?: string[]; // é™„ä»¶ URL
  };
}

// æœåŠ¡ç«¯æ¨é€
interface ServerMessage {
  type: "plan" | "thinking" | "tool_call" | "tool_result" | 
        "observation" | "replan" | "progress" | "final" | "error";
  data: any;
  timestamp: string;
  task_id: string;
}

// ç¤ºä¾‹æ¶ˆæ¯æµ
[
  { type: "plan", data: { steps: [...] }, task_id: "task_001" },
  { type: "thinking", data: { content: "æ­£åœ¨åˆ†ææ•°æ®ç»“æ„..." }, task_id: "task_001" },
  { type: "tool_call", data: { tool: "sql_query", args: {...} }, task_id: "task_001" },
  { type: "tool_result", data: { result: [...], duration: "1.2s" }, task_id: "task_001" },
  { type: "progress", data: { current: 2, total: 5, percent: 40 }, task_id: "task_001" },
  { type: "final", data: { summary: "...", outputs: [...] }, task_id: "task_001" }
]
```

---

## 11. æ•°æ®åº“è®¾è®¡

### 11.1 æ ¸å¿ƒè¡¨ç»“æ„

```sql
-- ç§Ÿæˆ·è¡¨
CREATE TABLE tbl_tenants (
    id SERIAL PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    config JSONB DEFAULT '{}',
    quota JSONB DEFAULT '{"monthly_tokens": 1000000}',
    create_time TIMESTAMP NOT NULL DEFAULT (now() AT TIME ZONE 'utc'),
    update_time TIMESTAMP NOT NULL DEFAULT (now() AT TIME ZONE 'utc'),
    deleted BOOLEAN NOT NULL DEFAULT false
);

-- ç”¨æˆ·è¡¨
CREATE TABLE tbl_users (
    id SERIAL PRIMARY KEY,
    tenant_id INTEGER REFERENCES tbl_tenants(id),
    username VARCHAR(100) NOT NULL,
    email VARCHAR(200),
    profile JSONB DEFAULT '{}',  -- ç”¨æˆ·ç”»åƒ
    preferences JSONB DEFAULT '{}',  -- åå¥½è®¾ç½®
    create_time TIMESTAMP NOT NULL DEFAULT (now() AT TIME ZONE 'utc'),
    update_time TIMESTAMP NOT NULL DEFAULT (now() AT TIME ZONE 'utc'),
    deleted BOOLEAN NOT NULL DEFAULT false
);

-- å·¥å…·è¡¨
CREATE TABLE tbl_tools (
    id SERIAL PRIMARY KEY,
    tenant_id INTEGER REFERENCES tbl_tenants(id),  -- NULL è¡¨ç¤ºç³»ç»Ÿå·¥å…·
    name VARCHAR(100) NOT NULL,
    description TEXT,
    type VARCHAR(50) NOT NULL,  -- builtin / mcp / custom
    config JSONB NOT NULL,
    enabled BOOLEAN DEFAULT true,
    create_time TIMESTAMP NOT NULL DEFAULT (now() AT TIME ZONE 'utc'),
    update_time TIMESTAMP NOT NULL DEFAULT (now() AT TIME ZONE 'utc'),
    deleted BOOLEAN NOT NULL DEFAULT false
);

-- MCP æœåŠ¡å™¨è¡¨
CREATE TABLE tbl_mcp_servers (
    id SERIAL PRIMARY KEY,
    tenant_id INTEGER REFERENCES tbl_tenants(id),
    name VARCHAR(100) NOT NULL,
    type VARCHAR(50) NOT NULL,  -- stdio / sse
    config JSONB NOT NULL,
    status VARCHAR(50) DEFAULT 'active',
    create_time TIMESTAMP NOT NULL DEFAULT (now() AT TIME ZONE 'utc'),
    update_time TIMESTAMP NOT NULL DEFAULT (now() AT TIME ZONE 'utc'),
    deleted BOOLEAN NOT NULL DEFAULT false
);

-- æ¨¡å‹é…ç½®è¡¨
CREATE TABLE tbl_models (
    id SERIAL PRIMARY KEY,
    tenant_id INTEGER REFERENCES tbl_tenants(id),
    name VARCHAR(100) NOT NULL,
    provider VARCHAR(50) NOT NULL,  -- openai / anthropic / deepseek
    model_id VARCHAR(100) NOT NULL,
    config JSONB NOT NULL,
    enabled BOOLEAN DEFAULT true,
    create_time TIMESTAMP NOT NULL DEFAULT (now() AT TIME ZONE 'utc'),
    update_time TIMESTAMP NOT NULL DEFAULT (now() AT TIME ZONE 'utc'),
    deleted BOOLEAN NOT NULL DEFAULT false
);

-- æ¨¡å‹ä½¿ç”¨é‡è¡¨
CREATE TABLE tbl_model_usage (
    id SERIAL PRIMARY KEY,
    tenant_id INTEGER REFERENCES tbl_tenants(id),
    user_id INTEGER REFERENCES tbl_users(id),
    model VARCHAR(100) NOT NULL,
    input_tokens INTEGER NOT NULL,
    output_tokens INTEGER NOT NULL,
    cost DECIMAL(10, 6),
    task_id VARCHAR(100),
    create_time TIMESTAMP NOT NULL DEFAULT (now() AT TIME ZONE 'utc')
);

-- ä»»åŠ¡è¡¨
CREATE TABLE tbl_tasks (
    id SERIAL PRIMARY KEY,
    task_uuid VARCHAR(100) UNIQUE NOT NULL,
    tenant_id INTEGER REFERENCES tbl_tenants(id),
    user_id INTEGER REFERENCES tbl_users(id),
    input TEXT NOT NULL,
    status VARCHAR(50) DEFAULT 'pending',  -- pending / running / completed / failed
    result JSONB,
    execution_history JSONB DEFAULT '[]',
    error_message TEXT,
    start_time TIMESTAMP,
    end_time TIMESTAMP,
    create_time TIMESTAMP NOT NULL DEFAULT (now() AT TIME ZONE 'utc'),
    update_time TIMESTAMP NOT NULL DEFAULT (now() AT TIME ZONE 'utc')
);

-- çŸ¥è¯†åº“è¡¨ï¼ˆå‘é‡å­˜å‚¨å…ƒæ•°æ®ï¼‰
CREATE TABLE tbl_knowledge (
    id SERIAL PRIMARY KEY,
    tenant_id INTEGER REFERENCES tbl_tenants(id),
    type VARCHAR(50) NOT NULL,  -- code / document / schema / meeting
    source VARCHAR(500),
    title VARCHAR(500),
    content TEXT,
    embedding vector(1536),  -- pgvector
    metadata JSONB DEFAULT '{}',
    create_time TIMESTAMP NOT NULL DEFAULT (now() AT TIME ZONE 'utc'),
    update_time TIMESTAMP NOT NULL DEFAULT (now() AT TIME ZONE 'utc'),
    deleted BOOLEAN NOT NULL DEFAULT false
);

-- åˆ›å»ºå‘é‡ç´¢å¼•
CREATE INDEX idx_knowledge_embedding ON tbl_knowledge 
USING ivfflat (embedding vector_cosine_ops) WITH (lists = 100);

-- æ–‡ä»¶è¡¨
CREATE TABLE tbl_files (
    id SERIAL PRIMARY KEY,
    tenant_id INTEGER REFERENCES tbl_tenants(id),
    task_id INTEGER REFERENCES tbl_tasks(id),
    name VARCHAR(500) NOT NULL,
    type VARCHAR(50) NOT NULL,  -- export / report / chart
    path VARCHAR(1000) NOT NULL,
    size INTEGER,
    create_time TIMESTAMP NOT NULL DEFAULT (now() AT TIME ZONE 'utc'),
    deleted BOOLEAN NOT NULL DEFAULT false
);
```

---

## 12. éƒ¨ç½²æ¶æ„

### 12.1 Docker Compose éƒ¨ç½²

```yaml
# docker-compose.yml
version: '3.8'

services:
  # API æœåŠ¡
  api:
    build: ./server
    ports:
      - "8000:8000"
    environment:
      - DATABASE_URL=postgresql://user:pass@postgres:5432/agent_platform
      - REDIS_URL=redis://redis:6379
      - LITELLM_CONFIG=/app/config/litellm_config.yaml
    depends_on:
      - postgres
      - redis
    volumes:
      - ./config:/app/config
      - ./workspace:/app/workspace

  # LiteLLM Proxy
  litellm:
    image: ghcr.io/berriai/litellm:main-latest
    ports:
      - "4000:4000"
    volumes:
      - ./config/litellm_config.yaml:/app/config.yaml
    command: --config /app/config.yaml

  # å‰ç«¯
  web:
    build: ./web
    ports:
      - "3000:80"
    depends_on:
      - api

  # PostgreSQL + pgvector
  postgres:
    image: pgvector/pgvector:pg16
    environment:
      - POSTGRES_USER=user
      - POSTGRES_PASSWORD=pass
      - POSTGRES_DB=agent_platform
    volumes:
      - postgres_data:/var/lib/postgresql/data
    ports:
      - "5432:5432"

  # Redis
  redis:
    image: redis:7-alpine
    ports:
      - "6379:6379"
    volumes:
      - redis_data:/data

  # MinIO (æ–‡ä»¶å­˜å‚¨)
  minio:
    image: minio/minio
    ports:
      - "9000:9000"
      - "9001:9001"
    environment:
      - MINIO_ROOT_USER=admin
      - MINIO_ROOT_PASSWORD=password
    volumes:
      - minio_data:/data
    command: server /data --console-address ":9001"

volumes:
  postgres_data:
  redis_data:
  minio_data:
```

### 12.2 ç”Ÿäº§ç¯å¢ƒæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        è´Ÿè½½å‡è¡¡ (Nginx)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚               â”‚               â”‚
              â–¼               â–¼               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   API Server    â”‚ â”‚   API Server    â”‚ â”‚   API Server    â”‚
â”‚   (FastAPI)     â”‚ â”‚   (FastAPI)     â”‚ â”‚   (FastAPI)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚               â”‚               â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚               â”‚               â”‚
              â–¼               â–¼               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ LiteLLM Proxy   â”‚ â”‚    Redis        â”‚ â”‚   PostgreSQL    â”‚
â”‚ (æ¨¡å‹ç½‘å…³)       â”‚ â”‚ (ç¼“å­˜/é˜Ÿåˆ—)      â”‚ â”‚  + pgvector     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 13. å¼€å‘è·¯çº¿å›¾

### Phase 1: MVP (2-3 å‘¨)

| ä»»åŠ¡ | æ—¶é—´ | äº§å‡º |
|------|------|------|
| OpenManus ç¯å¢ƒæ­å»º | 2 å¤© | åŸºç¡€ Agent è¿è¡Œ |
| LiteLLM é›†æˆ | 1 å¤© | æ¨¡å‹è·¯ç”±èƒ½åŠ› |
| Letta é›†æˆ | 3 å¤© | è®°å¿†ç®¡ç†èƒ½åŠ› |
| åŸºç¡€å·¥å…·å¼€å‘ | 3 å¤© | SQL/å¯¼å‡º/å›¾è¡¨å·¥å…· |
| WebSocket æ¥å£ | 2 å¤© | æµå¼è¾“å‡º |
| å‰ç«¯å¯¹è¯ç•Œé¢ | 5 å¤© | åŸºç¡€äº¤äº’ |
| åœºæ™¯ä¸€å®ç° | 3 å¤© | æ•°æ®å¯¼å‡ºæŠ¥å‘Š |

### Phase 2: å®Œå–„ (2-3 å‘¨)

| ä»»åŠ¡ | æ—¶é—´ | äº§å‡º |
|------|------|------|
| åœºæ™¯äºŒã€ä¸‰å®ç° | 4 å¤© | æ›´å¤šåœºæ™¯æ”¯æŒ |
| MCP å·¥å…·æ‰©å±• | 3 å¤© | GitHub/é£ä¹¦/æ—¥å† |
| çŸ¥è¯†åº“å¯¼å…¥ | 3 å¤© | ä¼ä¸šçŸ¥è¯†æ•´åˆ |
| ç®¡ç†åå° | 5 å¤© | å·¥å…·/æ¨¡å‹ç®¡ç† |
| æƒé™æ§åˆ¶ | 2 å¤© | å¤šç§Ÿæˆ·éš”ç¦» |

### Phase 3: ä¼˜åŒ– (æŒç»­)

| ä»»åŠ¡ | è¯´æ˜ |
|------|------|
| æ€§èƒ½ä¼˜åŒ– | å¹¶å‘å¤„ç†ã€ç¼“å­˜ä¼˜åŒ– |
| å®‰å…¨åŠ å›º | æ²™ç®±éš”ç¦»ã€è¾“å…¥æ ¡éªŒ |
| å¯è§‚æµ‹æ€§ | æ—¥å¿—ã€ç›‘æ§ã€å‘Šè­¦ |
| æ›´å¤šåœºæ™¯ | æ ¹æ®ç”¨æˆ·åé¦ˆæ‰©å±• |

---

## é™„å½• A: æŠ€æœ¯æ ˆç‰ˆæœ¬

| ç»„ä»¶ | ç‰ˆæœ¬ | è¯´æ˜ |
|------|------|------|
| Python | 3.12 | è¿è¡Œæ—¶ |
| FastAPI | 0.109+ | Web æ¡†æ¶ |
| OpenManus | latest | Agent æ¡†æ¶ |
| Letta | 0.6+ | è®°å¿†ç®¡ç† |
| LiteLLM | 1.55+ | æ¨¡å‹ç½‘å…³ |
| PostgreSQL | 16 | æ•°æ®åº“ |
| pgvector | 0.7+ | å‘é‡æ‰©å±• |
| Redis | 7 | ç¼“å­˜ |
| Vue | 3.4+ | å‰ç«¯æ¡†æ¶ |
| Node.js | 22+ | MCP è¿è¡Œæ—¶ |

---

## é™„å½• B: å‚è€ƒèµ„æº

- [OpenManus GitHub](https://github.com/FoundationAgents/OpenManus)
- [Letta æ–‡æ¡£](https://docs.letta.com/)
- [LiteLLM æ–‡æ¡£](https://docs.litellm.ai/)
- [MCP è§„èŒƒ](https://modelcontextprotocol.io/)
- [LangGraph æ–‡æ¡£](https://python.langchain.com/docs/langgraph)
